# ROCR-Runtime ç›®å½•ç»“æ„è¯¦è§£

## æ¦‚è¿°

`rocr-runtime` æ˜¯ ROCm çš„æ ¸å¿ƒè¿è¡Œæ—¶åº“ï¼ŒåŒ…å« HSA Runtime (ROCr) å’Œ Thunk Library (ROCt)ã€‚

## ç›®å½•æ ‘æ€»è§ˆ

```
rocr-runtime/
â”œâ”€â”€ libhsakmt/          # ROCt Thunk Library - ç”¨æˆ·æ€ä¸KFDé©±åŠ¨çš„æ¥å£å±‚
â”œâ”€â”€ runtime/            # HSA Runtime - HSAæ ‡å‡†å®ç°
â”œâ”€â”€ rocrtst/            # Runtimeæµ‹è¯•å¥—ä»¶
â”œâ”€â”€ samples/            # ç¤ºä¾‹ä»£ç 
â”œâ”€â”€ DEBIAN/             # DebianåŒ…ç®¡ç†é…ç½®
â”œâ”€â”€ RPM/                # RPMåŒ…ç®¡ç†é…ç½®
â”œâ”€â”€ cmake_modules/      # CMakeæ„å»ºå·¥å…·
â”œâ”€â”€ CMakeLists.txt      # ä¸»æ„å»ºé…ç½®
â”œâ”€â”€ README.md           # é¡¹ç›®è¯´æ˜
â””â”€â”€ LICENSE.txt         # è®¸å¯è¯
```

---

## æ ¸å¿ƒç›®å½•è¯¦è§£

### 1. `libhsakmt/` - ROCt Thunk Library

**å®šä½**ï¼šç”¨æˆ·æ€ä¸KFDå†…æ ¸é©±åŠ¨ä¹‹é—´çš„æ¥å£å±‚ï¼ˆ"å«ç‰‡"åº“ï¼‰

**ä¸»è¦èŒè´£**ï¼š
- å°è£…æ‰€æœ‰å¯¹ `/dev/kfd` çš„ ioctl ç³»ç»Ÿè°ƒç”¨
- æä¾›ç”¨æˆ·æ€ C API ç»™ HSA Runtime è°ƒç”¨
- å¤„ç†æ‹“æ‰‘å‘ç°ã€å†…å­˜ç®¡ç†ã€é˜Ÿåˆ—åˆ›å»ºç­‰åº•å±‚æ“ä½œ

**ç›®å½•ç»“æ„**ï¼š
```
libhsakmt/
â”œâ”€â”€ include/hsakmt/          # å…¬å…±å¤´æ–‡ä»¶
â”‚   â”œâ”€â”€ hsakmt.h             # ä¸»è¦APIæ¥å£å®šä¹‰
â”‚   â”œâ”€â”€ hsakmttypes.h        # ç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ hsakmtmodel.h        # æ¨¡å‹æ¥å£
â”‚   â””â”€â”€ linux/
â”‚       â””â”€â”€ kfd_ioctl.h      # KFD ioctlå‘½ä»¤å®šä¹‰
â”‚
â”œâ”€â”€ src/                     # å®ç°ä»£ç 
â”‚   â”œâ”€â”€ openclose.c          # æ‰“å¼€/å…³é—­KFDè®¾å¤‡
â”‚   â”œâ”€â”€ topology.c           # æ‹“æ‰‘å‘ç°
â”‚   â”œâ”€â”€ memory.c             # å†…å­˜åˆ†é…å’Œæ˜ å°„
â”‚   â”œâ”€â”€ queues.c             # é˜Ÿåˆ—ç®¡ç†
â”‚   â”œâ”€â”€ events.c             # äº‹ä»¶å¤„ç†
â”‚   â”œâ”€â”€ debug.c              # è°ƒè¯•æ”¯æŒ
â”‚   â”œâ”€â”€ svm.c                # Shared Virtual Memory
â”‚   â”œâ”€â”€ fmm.c                # Flat Memory Manager
â”‚   â”œâ”€â”€ pc_sampling.c        # PCé‡‡æ ·
â”‚   â”œâ”€â”€ perfctr.c            # æ€§èƒ½è®¡æ•°å™¨
â”‚   â””â”€â”€ virtio/              # VirtIOè™šæ‹ŸåŒ–æ”¯æŒ
â”‚       â””â”€â”€ ...
â”‚
â””â”€â”€ tests/                   # æµ‹è¯•ä»£ç 
    â””â”€â”€ kfdtest/             # KFDåŠŸèƒ½æµ‹è¯•
        â””â”€â”€ src/             # 89ä¸ªæµ‹è¯•æ–‡ä»¶
```

**å…³é”®APIç¤ºä¾‹**ï¼š
```c
// æ‰“å¼€KFDè®¾å¤‡
HSAKMT_STATUS hsaKmtOpenKFD(void);

// æ‹“æ‰‘å‘ç°
HSAKMT_STATUS hsaKmtAcquireSystemProperties(HsaSystemProperties*);

// å†…å­˜åˆ†é…
HSAKMT_STATUS hsaKmtAllocMemory(HSAuint32 NodeId, HSAuint64 Size, 
                                 HsaMemFlags MemFlags, void** MemoryAddress);

// é˜Ÿåˆ—åˆ›å»º
HSAKMT_STATUS hsaKmtCreateQueue(HSAuint32 NodeId, HSA_QUEUE_TYPE Type, ...);
```

**ç¼–è¯‘äº§ç‰©**ï¼š
- `libhsakmt.a` (é™æ€åº“ï¼Œé“¾æ¥åˆ° libhsa-runtime64.so ä¸­)

---

### 2. `runtime/` - HSA Runtime Core

**å®šä½**ï¼šHSA (Heterogeneous System Architecture) æ ‡å‡†çš„å®Œæ•´å®ç°

**ä¸»è¦èŒè´£**ï¼š
- å®ç° HSA 1.x/2.x æ ‡å‡† API
- ç®¡ç† HSA Agentsï¼ˆGPU/CPUèŠ‚ç‚¹ï¼‰
- AQLï¼ˆArchitected Queuing Languageï¼‰é˜Ÿåˆ—ç®¡ç†
- ä¿¡å·åŒæ­¥æœºåˆ¶
- å†…å­˜åŸŸç®¡ç†
- ä»£ç å¯¹è±¡åŠ è½½

**ç›®å½•ç»“æ„**ï¼š
```
runtime/
â”œâ”€â”€ hsa-runtime/             # HSA Runtimeæ ¸å¿ƒå®ç°
â”‚   â”œâ”€â”€ core/                # æ ¸å¿ƒåŠŸèƒ½
â”‚   â”‚   â”œâ”€â”€ common/          # å…¬å…±ç»„ä»¶
â”‚   â”‚   â”‚   â””â”€â”€ hsa_table_interface.cpp  # HSAå‡½æ•°è¡¨
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ driver/          # é©±åŠ¨é€‚é…å±‚
â”‚   â”‚   â”‚   â”œâ”€â”€ kfd/         # KFDé©±åŠ¨é€‚é…å™¨
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ amd_kfd_driver.cpp
â”‚   â”‚   â”‚   â”œâ”€â”€ virtio/      # VirtIOæ”¯æŒ
â”‚   â”‚   â”‚   â””â”€â”€ xdna/        # AMD XDNAåŠ é€Ÿå™¨
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ inc/             # å†…éƒ¨å¤´æ–‡ä»¶ (50+ä¸ª)
â”‚   â”‚   â”‚   â”œâ”€â”€ amd_aql_queue.h       # AQLé˜Ÿåˆ—
â”‚   â”‚   â”‚   â”œâ”€â”€ runtime.h             # Runtimeæ ¸å¿ƒ
â”‚   â”‚   â”‚   â”œâ”€â”€ agent.h               # Agentç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ signal.h              # ä¿¡å·
â”‚   â”‚   â”‚   â”œâ”€â”€ memory_region.h       # å†…å­˜åŸŸ
â”‚   â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ runtime/         # Runtimeå®ç° (40ä¸ªæ–‡ä»¶)
â”‚   â”‚   â”‚   â”œâ”€â”€ runtime.cpp           # Runtimeåˆå§‹åŒ–
â”‚   â”‚   â”‚   â”œâ”€â”€ agent.cpp             # Agentå®ç°
â”‚   â”‚   â”‚   â”œâ”€â”€ queue.cpp             # é˜Ÿåˆ—å®ç°
â”‚   â”‚   â”‚   â”œâ”€â”€ signal.cpp            # ä¿¡å·å®ç°
â”‚   â”‚   â”‚   â”œâ”€â”€ memory_region.cpp     # å†…å­˜åŸŸ
â”‚   â”‚   â”‚   â”œâ”€â”€ amd_topology.cpp      # æ‹“æ‰‘ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ amd_gpu_agent.cpp     # GPU Agent
â”‚   â”‚   â”‚   â”œâ”€â”€ amd_cpu_agent.cpp     # CPU Agent
â”‚   â”‚   â”‚   â”œâ”€â”€ amd_aql_queue.cpp     # AQLé˜Ÿåˆ—
â”‚   â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ util/            # å·¥å…·ç±»
â”‚   â”‚       â”œâ”€â”€ flag.cpp              # ç¯å¢ƒå˜é‡æ ‡å¿—
â”‚   â”‚       â”œâ”€â”€ timer.cpp             # è®¡æ—¶å™¨
â”‚   â”‚       â”œâ”€â”€ os_linux.cpp          # Linuxç³»ç»Ÿè°ƒç”¨
â”‚   â”‚       â””â”€â”€ ...
â”‚   â”‚
â”‚   â”œâ”€â”€ inc/                 # å…¬å…±HSAå¤´æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ hsa.h            # HSAæ ¸å¿ƒAPI
â”‚   â”‚   â”œâ”€â”€ hsa_ext_amd.h    # AMDæ‰©å±•
â”‚   â”‚   â”œâ”€â”€ amd_hsa_queue.h  # AQLå®šä¹‰
â”‚   â”‚   â”œâ”€â”€ amd_hsa_signal.h # ä¿¡å·å®šä¹‰
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚
â”‚   â”œâ”€â”€ image/               # Imageæ‰©å±•å®ç°
â”‚   â”‚   â”œâ”€â”€ image_manager*.cpp        # å›¾åƒç®¡ç†å™¨
â”‚   â”‚   â”œâ”€â”€ blit_object*.cpp          # Blitæ“ä½œ
â”‚   â”‚   â””â”€â”€ addrlib/                  # åœ°å€åº“
â”‚   â”‚       â””â”€â”€ ...
â”‚   â”‚
â”‚   â”œâ”€â”€ loader/              # ä»£ç å¯¹è±¡åŠ è½½å™¨
â”‚   â”‚   â”œâ”€â”€ executable.cpp            # å¯æ‰§è¡Œå¯¹è±¡
â”‚   â”‚   â””â”€â”€ AMDHSAKernelDescriptor.h  # Kernelæè¿°ç¬¦
â”‚   â”‚
â”‚   â”œâ”€â”€ libamdhsacode/       # HSAä»£ç å¯¹è±¡å¤„ç†
â”‚   â”‚   â”œâ”€â”€ amd_hsa_code.cpp          # ä»£ç å¯¹è±¡è§£æ
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚
â”‚   â””â”€â”€ pcs/                 # PC Samplingï¼ˆæ€§èƒ½åˆ†æï¼‰
â”‚       â””â”€â”€ ...
â”‚
â”œâ”€â”€ hsa-ext-finalize/        # Finalizeæ‰©å±•ï¼ˆå·²åºŸå¼ƒï¼‰
â”œâ”€â”€ hsa-ext-image/           # Imageæ‰©å±•
â”œâ”€â”€ hsa-runtime-tools/       # è¿è¡Œæ—¶å·¥å…·
â”œâ”€â”€ packages/                # æ‰“åŒ…é…ç½®
â””â”€â”€ docs/                    # æ–‡æ¡£
```

**å…³é”®åŠŸèƒ½æ¨¡å—**ï¼š

#### 2.1 æ ¸å¿ƒè¿è¡Œæ—¶ (`core/runtime/`)
```cpp
// hsa_init() - åˆå§‹åŒ–HSA Runtime
// æµç¨‹ï¼š
1. åŠ è½½ libhsakmt.so (Thunkåº“)
2. è°ƒç”¨ hsaKmtOpenKFD() æ‰“å¼€ /dev/kfd
3. æ‰«æç³»ç»Ÿæ‹“æ‰‘ï¼Œå‘ç°æ‰€æœ‰HSA Agents
4. åˆå§‹åŒ–å†…å­˜æ± å’ŒåŒºåŸŸ
5. è®¾ç½®ä¿¡å·å¤„ç†

// å…³é”®ç±»ï¼š
- core::Runtime        # Runtimeå•ä¾‹
- core::Agent          # HSA AgentæŠ½è±¡
- core::GpuAgent       # GPU Agentå®ç°
- core::CpuAgent       # CPU Agentå®ç°
- core::Queue          # é˜Ÿåˆ—æŠ½è±¡
- core::Signal         # ä¿¡å·æŠ½è±¡
- core::MemoryRegion   # å†…å­˜åŒºåŸŸ
```

#### 2.2 AQLé˜Ÿåˆ— (`core/runtime/amd_aql_queue.cpp`)
```cpp
// AQLåŒ…æäº¤æµç¨‹ï¼š
1. è·å–é˜Ÿåˆ—write_index
2. è®¡ç®—ç¯å½¢ç¼“å†²åŒºæ§½ä½
3. å¡«å……AQLåŒ…ï¼ˆé™¤headerå¤–ï¼‰
4. åŸå­å†™å…¥headeræ¿€æ´»åŒ…
5. å†™å…¥doorbellé€šçŸ¥GPU

// å…³é”®æ•°æ®ç»“æ„ï¼š
struct hsa_kernel_dispatch_packet_t {
  uint16_t header;
  uint16_t setup;
  uint16_t workgroup_size_x/y/z;
  uint32_t grid_size_x/y/z;
  uint64_t kernel_object;
  uint64_t kernarg_address;
  hsa_signal_t completion_signal;
};
```

#### 2.3 é©±åŠ¨é€‚é…å±‚ (`core/driver/kfd/`)
```cpp
// amd_kfd_driver.cpp
// åŠŸèƒ½ï¼š
- å°è£… libhsakmt API è°ƒç”¨
- å°† HSA Runtime æ¦‚å¿µæ˜ å°„åˆ° KFD æ¦‚å¿µ
- å¤„ç†é©±åŠ¨ç‰ˆæœ¬å…¼å®¹æ€§
```

**ç¼–è¯‘äº§ç‰©**ï¼š
- `libhsa-runtime64.so` (åŠ¨æ€åº“)
- `libhsa-runtime64.a` (é™æ€åº“å¯é€‰)

---

### 3. `rocrtst/` - Runtimeæµ‹è¯•å¥—ä»¶

**å®šä½**ï¼šHSA Runtime çš„å®Œæ•´æµ‹è¯•æ¡†æ¶

**ä¸»è¦èŒè´£**ï¼š
- éªŒè¯ HSA API åŠŸèƒ½æ­£ç¡®æ€§
- æ€§èƒ½æµ‹è¯•å’ŒåŸºå‡†æµ‹è¯•
- å‹åŠ›æµ‹è¯•å’Œç¨³å®šæ€§æµ‹è¯•

**ç›®å½•ç»“æ„**ï¼š
```
rocrtst/
â”œâ”€â”€ common/              # å…¬å…±æµ‹è¯•å·¥å…·
â”‚   â”œâ”€â”€ base_rocr.cc     # ROCråŸºç¡€ç±»
â”‚   â”œâ”€â”€ base_rocr_utils.cc # ROCrå·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ hsatimer.cc      # è®¡æ—¶å™¨
â”‚   â””â”€â”€ ...
â”‚
â”œâ”€â”€ gtest/               # Google Testæ¡†æ¶
â”‚   â”œâ”€â”€ include/gtest/
â”‚   â””â”€â”€ src/
â”‚
â”œâ”€â”€ suites/              # æµ‹è¯•å¥—ä»¶
â”‚   â”œâ”€â”€ functional/      # åŠŸèƒ½æµ‹è¯• (38ä¸ªæµ‹è¯•)
â”‚   â”‚   â”œâ”€â”€ memory_test.cc
â”‚   â”‚   â”œâ”€â”€ queue_test.cc
â”‚   â”‚   â”œâ”€â”€ signal_test.cc
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚
â”‚   â”œâ”€â”€ performance/     # æ€§èƒ½æµ‹è¯• (10ä¸ªæµ‹è¯•)
â”‚   â”‚   â”œâ”€â”€ copy_perf_test.cc
â”‚   â”‚   â”œâ”€â”€ kernel_perf_test.cc
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚
â”‚   â”œâ”€â”€ stress/          # å‹åŠ›æµ‹è¯•
â”‚   â””â”€â”€ negative/        # è´Ÿé¢æµ‹è¯•ï¼ˆé”™è¯¯å¤„ç†ï¼‰
â”‚
â”œâ”€â”€ samples/             # ç¤ºä¾‹ç¨‹åº
â”‚   â”œâ”€â”€ rocrinfo/        # è®¾å¤‡ä¿¡æ¯æŸ¥è¯¢
â”‚   â”œâ”€â”€ async_mem_copy/  # å¼‚æ­¥å†…å­˜æ‹·è´
â”‚   â”œâ”€â”€ binary_search/   # äºŒåˆ†æœç´¢ç¤ºä¾‹
â”‚   â””â”€â”€ ...
â”‚
â””â”€â”€ Kernels/             # æµ‹è¯•ç”¨OpenCLå†…æ ¸
    â”œâ”€â”€ binary_search_kernel.cl
    â””â”€â”€ ...
```

**æµ‹è¯•åˆ†ç±»**ï¼š

| æµ‹è¯•å¥—ä»¶ | æ–‡ä»¶æ•° | ä¸»è¦å†…å®¹ |
|---------|--------|---------|
| functional/ | 38 | Agentæšä¸¾ã€å†…å­˜åˆ†é…ã€é˜Ÿåˆ—åˆ›å»ºã€ä¿¡å·åŒæ­¥ç­‰ |
| performance/ | 10 | å†…å­˜å¸¦å®½ã€å†…æ ¸å¯åŠ¨å»¶è¿Ÿã€æ‹·è´æ€§èƒ½ç­‰ |
| stress/ | 4 | é•¿æ—¶é—´è¿è¡Œã€é«˜å¹¶å‘ã€èµ„æºè€—å°½ç­‰ |
| negative/ | 4 | é”™è¯¯å‚æ•°ã€å¼‚å¸¸æƒ…å†µç­‰ |

**ä½¿ç”¨ç¤ºä¾‹**ï¼š
```bash
# è¿è¡Œæ‰€æœ‰åŠŸèƒ½æµ‹è¯•
$ ./rocrtst --gtest_filter="functional/*"

# è¿è¡Œæ€§èƒ½æµ‹è¯•
$ ./rocrtst --gtest_filter="performance/*"

# æŸ¥çœ‹è®¾å¤‡ä¿¡æ¯
$ ./rocrinfo
```

---

### 4. `samples/` - ç¤ºä¾‹ä»£ç 

**å®šä½**ï¼šæ¼”ç¤ºå¦‚ä½•ä½¿ç”¨ HSA Runtime API

**ç›®å½•ç»“æ„**ï¼š
```
samples/
â”œâ”€â”€ common/              # å…¬å…±å·¥å…·ä»£ç 
â”‚   â”œâ”€â”€ hsa_rsrc_factory.cpp  # HSAèµ„æºå·¥å‚
â”‚   â”œâ”€â”€ common_utility.cpp    # é€šç”¨å·¥å…·
â”‚   â””â”€â”€ ...
â”‚
â””â”€â”€ GetInfo/             # è·å–è®¾å¤‡ä¿¡æ¯ç¤ºä¾‹
    â””â”€â”€ get_info.cpp
```

**ç¤ºä¾‹ç¨‹åºåŠŸèƒ½**ï¼š
- è®¾å¤‡æšä¸¾å’Œä¿¡æ¯æŸ¥è¯¢
- å†…å­˜åˆ†é…å’Œç®¡ç†
- é˜Ÿåˆ—åˆ›å»ºå’Œä½¿ç”¨
- ä¿¡å·åŒæ­¥
- å†…æ ¸æ‰§è¡Œ

---

### 5. æ‰“åŒ…å’Œé…ç½®ç›®å½•

#### 5.1 `DEBIAN/` - DebianåŒ…ç®¡ç†

```
DEBIAN/
â”œâ”€â”€ Binary/              # äºŒè¿›åˆ¶åŒ…é…ç½®
â”‚   â”œâ”€â”€ postinst.in      # å®‰è£…åè„šæœ¬
â”‚   â””â”€â”€ prerm.in         # åˆ é™¤å‰è„šæœ¬
â”œâ”€â”€ Dev/                 # å¼€å‘åŒ…é…ç½®
â”‚   â”œâ”€â”€ postinst.in
â”‚   â””â”€â”€ prerm.in
â””â”€â”€ preinst              # å®‰è£…å‰è„šæœ¬
```

**ç”Ÿæˆçš„åŒ…**ï¼š
- `hsa-rocr` - è¿è¡Œæ—¶äºŒè¿›åˆ¶åŒ…
- `hsa-rocr-dev` - å¼€å‘åŒ…ï¼ˆå¤´æ–‡ä»¶ï¼‰

#### 5.2 `RPM/` - RedHatåŒ…ç®¡ç†

```
RPM/
â”œâ”€â”€ Binary/
â”œâ”€â”€ Dev/
â””â”€â”€ hsa-rocr.spec.in     # RPMè§„èŒƒæ–‡ä»¶
```

#### 5.3 `cmake_modules/` - CMakeå·¥å…·

```
cmake_modules/
â””â”€â”€ utils.cmake          # CMakeå·¥å…·å‡½æ•°
```

---

## ç¼–è¯‘æµç¨‹å’Œäº§ç‰©

### ç¼–è¯‘æµç¨‹

```bash
# 1. é…ç½®æ„å»º
mkdir build && cd build
cmake -DCMAKE_INSTALL_PREFIX=/opt/rocm ..

# 2. ç¼–è¯‘
make

# 3. å®‰è£…
make install
```

### ç¼–è¯‘äº§ç‰©

```
ç¼–è¯‘åç”Ÿæˆï¼š

/opt/rocm/
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ libhsa-runtime64.so       â† runtime/hsa-runtime/
â”‚   â””â”€â”€ (libhsakmt é™æ€é“¾æ¥åœ¨é‡Œé¢)
â”‚
â”œâ”€â”€ include/hsa/
â”‚   â”œâ”€â”€ hsa.h                     â† runtime/hsa-runtime/inc/
â”‚   â”œâ”€â”€ hsa_ext_amd.h
â”‚   â””â”€â”€ ...
â”‚
â””â”€â”€ bin/
    â”œâ”€â”€ rocrtst                   â† rocrtst/
    â””â”€â”€ rocrinfo                  â† rocrtst/samples/
```

---

## ä¾èµ–å…³ç³»å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              åº”ç”¨ç¨‹åº (CLR/HIP/OpenCL)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚ é“¾æ¥
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            libhsa-runtime64.so                         â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚  runtime/hsa-runtime/                        â”‚     â”‚
â”‚  â”‚  â€¢ HSA APIå®ç°                                â”‚     â”‚
â”‚  â”‚  â€¢ Agent/Queue/Signalç®¡ç†                    â”‚     â”‚
â”‚  â”‚  â€¢ AQLè°ƒåº¦                                    â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                      â”‚ é™æ€é“¾æ¥                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚  libhsakmt/ (Thunk Library)                  â”‚     â”‚
â”‚  â”‚  â€¢ å°è£…ioctlè°ƒç”¨                              â”‚     â”‚
â”‚  â”‚  â€¢ æ‹“æ‰‘/å†…å­˜/é˜Ÿåˆ—ç®¡ç†                         â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚ ioctlç³»ç»Ÿè°ƒç”¨
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            KFDé©±åŠ¨ (/dev/kfd)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## å…³é”®æ–‡ä»¶è¯´æ˜

### æ ¸å¿ƒå¤´æ–‡ä»¶

| æ–‡ä»¶ | ä½ç½® | è¯´æ˜ |
|-----|------|------|
| `hsa.h` | `runtime/hsa-runtime/inc/` | HSAæ ¸å¿ƒAPIå®šä¹‰ |
| `hsa_ext_amd.h` | `runtime/hsa-runtime/inc/` | AMDæ‰©å±•API |
| `amd_hsa_queue.h` | `runtime/hsa-runtime/inc/` | AQLé˜Ÿåˆ—å®šä¹‰ |
| `hsakmt.h` | `libhsakmt/include/hsakmt/` | Thunkåº“API |
| `kfd_ioctl.h` | `libhsakmt/include/hsakmt/linux/` | KFD ioctlå®šä¹‰ |

### æ ¸å¿ƒå®ç°æ–‡ä»¶

| æ–‡ä»¶ | ä½ç½® | è¯´æ˜ |
|-----|------|------|
| `runtime.cpp` | `runtime/hsa-runtime/core/runtime/` | Runtimeåˆå§‹åŒ– |
| `amd_aql_queue.cpp` | `runtime/hsa-runtime/core/runtime/` | AQLé˜Ÿåˆ—å®ç° |
| `amd_gpu_agent.cpp` | `runtime/hsa-runtime/core/runtime/` | GPU Agent |
| `signal.cpp` | `runtime/hsa-runtime/core/runtime/` | ä¿¡å·åŒæ­¥ |
| `openclose.c` | `libhsakmt/src/` | æ‰“å¼€/å…³é—­KFD |
| `queues.c` | `libhsakmt/src/` | é˜Ÿåˆ—ç®¡ç† |
| `memory.c` | `libhsakmt/src/` | å†…å­˜ç®¡ç† |

---

## æ€»ç»“

### ç›®å½•èŒè´£æ€»ç»“

| ç›®å½• | è§’è‰² | ç¼–è¯‘äº§ç‰© | ä¸»è¦ç”¨æˆ· |
|-----|------|----------|---------|
| `libhsakmt/` | ç”¨æˆ·-å†…æ ¸æ¥å£ | é™æ€åº“ï¼ˆé“¾æ¥åˆ°runtimeï¼‰ | HSA Runtime |
| `runtime/` | HSAæ ‡å‡†å®ç° | libhsa-runtime64.so | åº”ç”¨/CLR |
| `rocrtst/` | æµ‹è¯•æ¡†æ¶ | rocrtstå¯æ‰§è¡Œæ–‡ä»¶ | æµ‹è¯•å·¥ç¨‹å¸ˆ |
| `samples/` | ç¤ºä¾‹ä»£ç  | ç¤ºä¾‹ç¨‹åº | åº”ç”¨å¼€å‘è€… |

### å…³é”®è°ƒç”¨é“¾

```
åº”ç”¨ä»£ç 
    â†“ hsa_init()
runtime/hsa-runtime/core/runtime/runtime.cpp
    â†“ hsaKmtOpenKFD()
libhsakmt/src/openclose.c
    â†“ ioctl(kfd_fd, ...)
KFDé©±åŠ¨ (/dev/kfd)
```

### å­¦ä¹ å»ºè®®

1. **å…¥é—¨**ï¼šå…ˆçœ‹ `samples/` çš„ç¤ºä¾‹ä»£ç 
2. **APIç†è§£**ï¼šé˜…è¯» `runtime/hsa-runtime/inc/hsa.h`
3. **å®ç°ç»†èŠ‚**ï¼šç ”ç©¶ `runtime/hsa-runtime/core/runtime/`
4. **åº•å±‚æœºåˆ¶**ï¼šåˆ†æ `libhsakmt/src/`
5. **æµ‹è¯•éªŒè¯**ï¼šè¿è¡Œ `rocrtst/` çš„æµ‹è¯•

è¿™ä¸ªç›®å½•ç»“æ„ä½“ç°äº†ä»åº•å±‚é©±åŠ¨æ¥å£(libhsakmt)ã€åˆ°æ ‡å‡†è¿è¡Œæ—¶å®ç°(runtime)ã€å†åˆ°æµ‹è¯•å’Œç¤ºä¾‹(rocrtst/samples)çš„å®Œæ•´æŠ€æœ¯æ ˆã€‚

---

## å¿«é€Ÿå‚è€ƒå›¾

### ç›®å½•åŠŸèƒ½ä¸€è§ˆ

```
rocr-runtime/
â”‚
â”œâ”€â”€ ğŸ”Œ libhsakmt/          â”â”â”â”â”“
â”‚   Thunk Library              â”ƒ
â”‚   ç”¨æˆ·æ€ â†” KFDé©±åŠ¨           â”ƒ æ ¸å¿ƒè¿è¡Œæ—¶
â”‚   å°è£…ioctlè°ƒç”¨              â”ƒ (ç¼–è¯‘æˆä¸€ä¸ªåº“)
â”‚   ç¼–è¯‘æˆé™æ€åº“               â”ƒ
â”‚   â†“                          â”ƒ
â”œâ”€â”€ ğŸ¯ runtime/            â”â”â”â”â”›
â”‚   HSA Runtimeå®ç°
â”‚   HSAæ ‡å‡†API
â”‚   Agent/Queue/Signalç®¡ç†
â”‚   ç¼–è¯‘æˆ libhsa-runtime64.so
â”‚   â†“
â”œâ”€â”€ âœ… rocrtst/
â”‚   æµ‹è¯•å¥—ä»¶
â”‚   éªŒè¯åŠŸèƒ½æ­£ç¡®æ€§
â”‚   æ€§èƒ½åŸºå‡†æµ‹è¯•
â”‚   â†“
â””â”€â”€ ğŸ“š samples/
    ç¤ºä¾‹ä»£ç 
    æ¼”ç¤ºAPIä½¿ç”¨
```

### åˆ†å±‚æ¶æ„è§†å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Layer 4: åº”ç”¨å±‚                         â”‚
â”‚              (CLR, HIP, OpenCL, ç”¨æˆ·åº”ç”¨)                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚ hsa_*() APIè°ƒç”¨
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Layer 3: HSA Runtime                   â”‚
â”‚              (runtime/hsa-runtime/)                     â”‚
â”‚                                                          â”‚
â”‚  â€¢ hsa_init()           â€¢ hsa_queue_create()            â”‚
â”‚  â€¢ hsa_iterate_agents() â€¢ hsa_signal_create()           â”‚
â”‚  â€¢ hsa_memory_*()       â€¢ AQLåŒ…è°ƒåº¦                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚ hsaKmt*() APIè°ƒç”¨
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Layer 2: Thunk Library                 â”‚
â”‚                  (libhsakmt/)                           â”‚
â”‚                                                          â”‚
â”‚  â€¢ hsaKmtOpenKFD()      â€¢ hsaKmtCreateQueue()           â”‚
â”‚  â€¢ hsaKmtAllocMemory()  â€¢ hsaKmtMapMemoryToGPU()        â”‚
â”‚  â€¢ å°è£…ioctlè°ƒç”¨                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚ ioctlç³»ç»Ÿè°ƒç”¨
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Layer 1: KFDé©±åŠ¨                        â”‚
â”‚                  (/dev/kfd)                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ä»£ç é‡å’Œå¤æ‚åº¦å¯¹æ¯”

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      ç›®å½•           â”‚  ä»£ç è¡Œæ•° â”‚ æ–‡ä»¶æ•°   â”‚  å¤æ‚åº¦   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ libhsakmt/src/     â”‚  ~15K    â”‚  ~20     â”‚   â­â­â­   â”‚
â”‚ runtime/core/      â”‚  ~50K    â”‚  ~80     â”‚  â­â­â­â­   â”‚
â”‚ runtime/image/     â”‚  ~20K    â”‚  ~40     â”‚   â­â­â­   â”‚
â”‚ rocrtst/           â”‚  ~30K    â”‚  ~100    â”‚   â­â­     â”‚
â”‚ samples/           â”‚  ~5K     â”‚  ~20     â”‚    â­      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å¤æ‚åº¦è¯´æ˜ï¼š
â­      - ç®€å•ç¤ºä¾‹ä»£ç 
â­â­    - æµ‹è¯•ä»£ç ï¼Œé€»è¾‘æ¸…æ™°
â­â­â­  - ç³»ç»Ÿç¼–ç¨‹ï¼Œæ¶‰åŠé©±åŠ¨äº¤äº’
â­â­â­â­ - å¤æ‚çš„è¿è¡Œæ—¶ç³»ç»Ÿ
```

### æ–‡ä»¶ç±»å‹åˆ†å¸ƒ

```
libhsakmt/
â”œâ”€â”€ ğŸ“„ .c   (Cæºæ–‡ä»¶)      â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 90%
â”œâ”€â”€ ğŸ“‹ .h   (å¤´æ–‡ä»¶)       â”â”â” 10%
â””â”€â”€ ç¼–è¯‘è¯­è¨€: çº¯C

runtime/hsa-runtime/
â”œâ”€â”€ ğŸ“ .cpp (C++æºæ–‡ä»¶)    â”â”â”â”â”â”â”â”â”â”â”â” 60%
â”œâ”€â”€ ğŸ“‹ .h   (å¤´æ–‡ä»¶)       â”â”â”â”â”â”â”â” 35%
â”œâ”€â”€ ğŸ“œ .hpp (C++å¤´æ–‡ä»¶)    â”â” 5%
â””â”€â”€ ç¼–è¯‘è¯­è¨€: C++11

rocrtst/
â”œâ”€â”€ ğŸ“ .cc/.cpp (C++æº)    â”â”â”â”â”â”â”â”â”â”â”â”â”â” 70%
â”œâ”€â”€ ğŸ“‹ .h/.hpp  (å¤´æ–‡ä»¶)   â”â”â”â”â”â”â” 30%
â””â”€â”€ ç¼–è¯‘è¯­è¨€: C++11 + Google Test
```

### å…³é”®APIå¯¹ç…§è¡¨

| libhsakmt (Thunk) | HSA Runtime | åŠŸèƒ½ |
|-------------------|-------------|------|
| `hsaKmtOpenKFD()` | `hsa_init()` | åˆå§‹åŒ– |
| `hsaKmtAcquireSystemProperties()` | `hsa_iterate_agents()` | å‘ç°è®¾å¤‡ |
| `hsaKmtAllocMemory()` | `hsa_memory_allocate()` | åˆ†é…å†…å­˜ |
| `hsaKmtCreateQueue()` | `hsa_queue_create()` | åˆ›å»ºé˜Ÿåˆ— |
| `hsaKmtMapMemoryToGPU()` | (è‡ªåŠ¨å¤„ç†) | æ˜ å°„å†…å­˜ |

### å…¸å‹å¼€å‘åœºæ™¯

#### åœºæ™¯1: åº”ç”¨å¼€å‘è€…

```
åªéœ€è¦ï¼š
âœ… runtime/hsa-runtime/inc/*.h (å¤´æ–‡ä»¶)
âœ… libhsa-runtime64.so (åº“æ–‡ä»¶)

ä¸éœ€è¦ï¼š
âŒ libhsakmt çš„ä»»ä½•æ–‡ä»¶
âŒ runtime çš„å®ç°ä»£ç 
```

#### åœºæ™¯2: Runtimeå¼€å‘è€…

```
éœ€è¦ä¿®æ”¹ï¼š
âœ… runtime/hsa-runtime/core/ (å®ç°)
âœ… libhsakmt/src/ (å¯èƒ½éœ€è¦)

æµ‹è¯•ï¼š
âœ… rocrtst/ (è¿è¡Œæµ‹è¯•)
```

#### åœºæ™¯3: é©±åŠ¨å¼€å‘è€…

```
éœ€è¦äº†è§£ï¼š
âœ… libhsakmt/include/hsakmt/linux/kfd_ioctl.h
âœ… libhsakmt/src/ (å¦‚ä½•è°ƒç”¨ioctl)

ä¿®æ”¹ï¼š
âœ… KFDé©±åŠ¨ä»£ç  (åœ¨å¦ä¸€ä¸ªä»“åº“)
```

### å­¦ä¹ è·¯å¾„æ¨è

```
åˆå­¦è€…è·¯å¾„:
1. ğŸ“š samples/GetInfo/        â† ä»è¿™é‡Œå¼€å§‹
2. ğŸ“– runtime/inc/hsa.h       â† ç†è§£API
3. âœ… rocrtst/samples/        â† çœ‹æ›´å¤šä¾‹å­
4. ğŸ“ runtime/core/runtime/   â† æ·±å…¥å®ç°

é©±åŠ¨å¼€å‘è€…è·¯å¾„:
1. ğŸ“„ libhsakmt/include/      â† äº†è§£æ¥å£
2. ğŸ”Œ libhsakmt/src/          â† çœ‹å®ç°
3. ğŸ› libhsakmt/tests/kfdtest/â† æµ‹è¯•ç”¨ä¾‹
4. ğŸ”§ KFDé©±åŠ¨ä»£ç              â† å†…æ ¸é©±åŠ¨

æ€§èƒ½ä¼˜åŒ–è·¯å¾„:
1. âš¡ rocrtst/performance/    â† æ€§èƒ½æµ‹è¯•
2. ğŸ“Š runtime/core/runtime/   â† çƒ­ç‚¹ä»£ç 
3. ğŸ¯ libhsakmt/src/queues.c  â† é˜Ÿåˆ—æäº¤
4. ğŸ“ˆ åˆ†æå·¥å…·                â† rocprofç­‰
```

### è°ƒè¯•æŠ€å·§

```bash
# 1. è®¾ç½®ç¯å¢ƒå˜é‡å¯ç”¨è°ƒè¯•æ—¥å¿—
export HSA_TOOLS_LIB=libhsa-runtime-tools64.so
export HSA_ENABLE_DEBUG=1

# 2. è¿è¡Œåº”ç”¨
./myapp

# 3. æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
# å¯ä»¥çœ‹åˆ°:
# - HSA APIè°ƒç”¨
# - Queueæäº¤
# - å†…å­˜åˆ†é…
# - Signalç­‰å¾…

# 4. ä½¿ç”¨GDBè°ƒè¯•
gdb --args ./myapp
(gdb) break hsa_queue_create
(gdb) run
# æ–­ç‚¹ä¼šåœåœ¨ runtime/hsa-runtime/core/runtime/queue.cpp
```

### å¸¸è§é—®é¢˜å®šä½

| é—®é¢˜ | æŸ¥çœ‹ç›®å½• |
|------|---------|
| HSAåˆå§‹åŒ–å¤±è´¥ | `runtime/core/runtime/runtime.cpp` |
| é˜Ÿåˆ—åˆ›å»ºå¤±è´¥ | `libhsakmt/src/queues.c` â†’ KFDé©±åŠ¨ |
| å†…å­˜åˆ†é…å¤±è´¥ | `libhsakmt/src/memory.c` â†’ KFDé©±åŠ¨ |
| AQLåŒ…ä¸æ‰§è¡Œ | `runtime/core/runtime/amd_aql_queue.cpp` |
| ä¿¡å·è¶…æ—¶ | `runtime/core/runtime/signal.cpp` |
| æ‹“æ‰‘å‘ç°é”™è¯¯ | `libhsakmt/src/topology.c` |

---

## æ€»ç»“å›¾ç¤º

```
rocr-runtime å°±åƒä¸€ä¸ªä¸‰æ˜æ²»ç»“æ„:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ğŸ åº”ç”¨å±‚ (samples/æµ‹è¯•)          â”‚  â† é¡¶å±‚ï¼šæ€ä¹ˆç”¨
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   ğŸ¥“ HSA Runtime (runtime/)         â”‚  â† ä¸­å±‚ï¼šæ ‡å‡†å®ç°
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   ğŸ¥¬ Thunkåº“ (libhsakmt/)           â”‚  â† åº•å±‚ï¼šé©±åŠ¨æ¥å£
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   ğŸ KFDé©±åŠ¨ (ä¸åœ¨æ­¤repo)           â”‚  â† å†…æ ¸ï¼šç¡¬ä»¶æ§åˆ¶
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ¯ä¸€å±‚éƒ½æœ‰æ˜ç¡®çš„èŒè´£ï¼Œäº’ä¸å¹²æ‰°ä½†ç´§å¯†é…åˆï¼
```

