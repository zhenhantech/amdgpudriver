[0;34mâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[0;34mStream Priority æµ‹è¯• - å¯ç”¨è¯¦ç»†æ—¥å¿—[0m
[0;34mâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ„¹ï¸  æ—¥å¿—ç›®å½•: logs_20260129_175731[0m

[0;34mâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[0;34mæ­¥éª¤ 1: ç¼–è¯‘æµ‹è¯•ç¨‹åº[0m
[0;34mâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[0;32mâœ… ç¼–è¯‘æˆåŠŸ[0m

[0;34mâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[0;34mæ­¥éª¤ 2: é…ç½®æ—¥å¿—ç¯å¢ƒ[0m
[0;34mâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ„¹ï¸  HIP/HSA æ—¥å¿—çº§åˆ«:[0m
  AMD_LOG_LEVEL        = 5 (5=æœ€è¯¦ç»†)
  HIP_TRACE_API        = 1 (1=å¯ç”¨)
  HIP_DB               = 0x1 (0x1=debug)
  AMD_SERIALIZE_KERNEL = 0 (0=ä¸ä¸²è¡ŒåŒ–)
  GPU_MAX_HW_QUEUES    = 8

[0;34mâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[0;34mæ­¥éª¤ 3: è¿è¡Œå•è¿›ç¨‹æµ‹è¯• (test_concurrent)[0m
[0;34mâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[1;33mâ„¹ï¸  è¿è¡Œ ./test_concurrent[0m
[1;33mâ„¹ï¸  è¾“å‡ºä¿å­˜åˆ°: logs_20260129_175731/test_concurrent.log[0m

[0;32mâœ… test_concurrent è¿è¡ŒæˆåŠŸ[0m
[1;33mâ„¹ï¸  æœ€å 30 è¡Œè¾“å‡º:[0m
:3:hip_stream.cpp           :428 : 20174704528 us: [pid:459769 tid: 0x7f8edc1c4400] hipStreamDestroy: Returned hipSuccess : 
:3:hip_stream.cpp           :390 : 20174704530 us: [pid:459769 tid: 0x7f8edc1c4400] [32m hipStreamDestroy ( stream:0x208cd70 ) [0m
:4:rocdevice.cpp            :2304: 20174704536 us: [pid:459769 tid: 0x7f8edc1c4400] Free hsa memory (nil)
:3:rocdevice.cpp            :3173: 20174704539 us: [pid:459769 tid: 0x7f8edc1c4400] releaseQueue refCount:0x7f8acc200000 (0)
:4:rocdevice.cpp            :2304: 20174704680 us: [pid:459769 tid: 0x7f8edc1c4400] Free hsa memory 0x7f8abe700000
:4:rocdevice.cpp            :2304: 20174704754 us: [pid:459769 tid: 0x7f8edc1c4400] Free hsa memory 0x7f8abaa00000
:3:hip_stream.cpp           :428 : 20174704769 us: [pid:459769 tid: 0x7f8edc1c4400] hipStreamDestroy: Returned hipSuccess : 
:4:rocdevice.cpp            :2304: 20174705062 us: [pid:459769 tid: 0x7f8edc1c4400] Free hsa memory 0x7f8ad0c00000
:4:rocdevice.cpp            :2304: 20174705128 us: [pid:459769 tid: 0x7f8edc1c4400] Free hsa memory 0x7f8edc1b6000
:3:rocdevice.cpp            :286 : 20174705132 us: [pid:459769 tid: 0x7f8edc1c4400] Deleting hardware queue 0x7f8acc600000 with refCount 0
:3:rocdevice.cpp            :286 : 20174707354 us: [pid:459769 tid: 0x7f8edc1c4400] Deleting hardware queue 0x7f8acc200000 with refCount 0
:3:rocdevice.cpp            :286 : 20174709566 us: [pid:459769 tid: 0x7f8edc1c4400] Deleting hardware queue 0x7f8acc400000 with refCount 0
:3:rocdevice.cpp            :286 : 20174711781 us: [pid:459769 tid: 0x7f8edc1c4400] Deleting hardware queue 0x7f8acd200000 with refCount 0


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
æ¸…ç†èµ„æº
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âœ… æ¸…ç†å®Œæˆ

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
æµ‹è¯•æ€»ç»“
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âœ… åˆ›å»ºäº† 4 ä¸ªç‹¬ç«‹çš„ Stream
âœ… æ¯ä¸ª Stream æœ‰å”¯ä¸€çš„åœ°å€
âœ… æ¯ä¸ª Stream æœ‰ç‹¬ç«‹çš„ä¼˜å…ˆçº§
âœ… æ‰€æœ‰ Stream å¯ä»¥å¹¶å‘æäº¤ kernel

ç»“è®º: æ¯ä¸ª Stream éƒ½æœ‰ç‹¬ç«‹çš„ HSA Queue å’Œ ring-buffer
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

[0;34mâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[0;34mæ­¥éª¤ 4: åˆ†ææ—¥å¿—[0m
[0;34mâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
â”€â”€â”€ æœç´¢ Stream åˆ›å»º â”€â”€â”€
[1;33mâ„¹ï¸  æ‰¾åˆ° 8 æ¡ Stream åˆ›å»ºè®°å½•[0m
è¯¦ç»†ä¿¡æ¯ä¿å­˜åœ¨: logs_20260129_175731/stream_create.txt
å‰ 10 æ¡:
:3:hip_stream.cpp           :293 : 20159561929 us: [pid:459769 tid: 0x7f8edc1c4400] [32m hipStreamCreateWithPriority ( 0x7fffea224e88, 0, -1 ) [0m
:3:hip_stream.cpp           :308 : 20159685100 us: [pid:459769 tid: 0x7f8edc1c4400] hipStreamCreateWithPriority: Returned hipSuccess : stream:0x1952020
:3:hip_stream.cpp           :293 : 20159685107 us: [pid:459769 tid: 0x7f8edc1c4400] [32m hipStreamCreateWithPriority ( 0x7fffea224e80, 0, 1 ) [0m
:3:hip_stream.cpp           :308 : 20159690220 us: [pid:459769 tid: 0x7f8edc1c4400] hipStreamCreateWithPriority: Returned hipSuccess : stream:0x20a2490
:3:hip_stream.cpp           :293 : 20159690227 us: [pid:459769 tid: 0x7f8edc1c4400] [32m hipStreamCreateWithPriority ( 0x7fffea224e78, 0, -1 ) [0m
:3:hip_stream.cpp           :308 : 20159695165 us: [pid:459769 tid: 0x7f8edc1c4400] hipStreamCreateWithPriority: Returned hipSuccess : stream:0x2099db0
:3:hip_stream.cpp           :293 : 20159695171 us: [pid:459769 tid: 0x7f8edc1c4400] [32m hipStreamCreateWithPriority ( 0x7fffea224e70, 0, 0 ) [0m
:3:hip_stream.cpp           :308 : 20159700277 us: [pid:459769 tid: 0x7f8edc1c4400] hipStreamCreateWithPriority: Returned hipSuccess : stream:0x208cd70

â”€â”€â”€ æœç´¢ Queue åˆ›å»º â”€â”€â”€
[1;33mâ„¹ï¸  æœªæ‰¾åˆ° Queue åˆ›å»ºæ—¥å¿—[0m

â”€â”€â”€ æœç´¢ Doorbell ä¿¡æ¯ â”€â”€â”€
[1;33mâ„¹ï¸  æ‰¾åˆ° 1 æ¡ Doorbell è®°å½•[0m
è¯¦ç»†ä¿¡æ¯ä¿å­˜åœ¨: logs_20260129_175731/doorbell.txt
å‰ 10 æ¡:
  2. cat /proc/459769/maps | grep doorbell

â”€â”€â”€ æœç´¢ Priority ä¿¡æ¯ â”€â”€â”€
[1;33mâ„¹ï¸  æ‰¾åˆ° 28 æ¡ Priority è®°å½•[0m
è¯¦ç»†ä¿¡æ¯ä¿å­˜åœ¨: logs_20260129_175731/priority.txt
å‰ 10 æ¡:
:3:hip_stream.cpp           :293 : 20159561929 us: [pid:459769 tid: 0x7f8edc1c4400] [32m hipStreamCreateWithPriority ( 0x7fffea224e88, 0, -1 ) [0m
:3:rocdevice.cpp            :2967: 20159561937 us: [pid:459769 tid: 0x7f8edc1c4400] Number of allocated hardware queues with low priority: 0, with normal priority: 0, with high priority: 0, maximum per priority is: 8
:3:rocdevice.cpp            :3048: 20159570897 us: [pid:459769 tid: 0x7f8edc1c4400] Created SWq=0x7f8edc1a8000 to map on HWq=0x7f8acd200000 with size 16384 with priority 2, cooperative: 0
:3:hip_stream.cpp           :308 : 20159685100 us: [pid:459769 tid: 0x7f8edc1c4400] hipStreamCreateWithPriority: Returned hipSuccess : stream:0x1952020
:3:hip_stream.cpp           :293 : 20159685107 us: [pid:459769 tid: 0x7f8edc1c4400] [32m hipStreamCreateWithPriority ( 0x7fffea224e80, 0, 1 ) [0m
:3:rocdevice.cpp            :2967: 20159685120 us: [pid:459769 tid: 0x7f8edc1c4400] Number of allocated hardware queues with low priority: 0, with normal priority: 0, with high priority: 1, maximum per priority is: 8
:3:rocdevice.cpp            :3048: 20159689582 us: [pid:459769 tid: 0x7f8edc1c4400] Created SWq=0x7f8edc1a2000 to map on HWq=0x7f8acc600000 with size 16384 with priority 0, cooperative: 0
:3:hip_stream.cpp           :308 : 20159690220 us: [pid:459769 tid: 0x7f8edc1c4400] hipStreamCreateWithPriority: Returned hipSuccess : stream:0x20a2490
:3:hip_stream.cpp           :293 : 20159690227 us: [pid:459769 tid: 0x7f8edc1c4400] [32m hipStreamCreateWithPriority ( 0x7fffea224e78, 0, -1 ) [0m
:3:rocdevice.cpp            :2967: 20159690232 us: [pid:459769 tid: 0x7f8edc1c4400] Number of allocated hardware queues with low priority: 1, with normal priority: 0, with high priority: 1, maximum per priority is: 8

â”€â”€â”€ æœç´¢ Warning/Error â”€â”€â”€
[0;32mâœ… æ²¡æœ‰ Warning/Error[0m

[0;34mâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[0;34mæ­¥éª¤ 5: è¿è¡Œåº”ç”¨ A (å¯é€‰)[0m
[0;34mâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
æ˜¯å¦è¿è¡Œ test_app_Aï¼Ÿ(y/N) 

[0;34mâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[0;34mæ­¥éª¤ 6: ç”Ÿæˆæµ‹è¯•æŠ¥å‘Š[0m
[0;34mâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
# Stream Priority æµ‹è¯•æŠ¥å‘Šï¼ˆè¯¦ç»†æ—¥å¿—ï¼‰

**ç”Ÿæˆæ—¶é—´**: Thu Jan 29 05:58:01 PM CST 2026  
**æ—¥å¿—ç›®å½•**: logs_20260129_175731

---

## æµ‹è¯•ç¯å¢ƒ

```
æ“ä½œç³»ç»Ÿ: Linux hjbog-srdc-26.amd.com 5.10.134-19.1.al8.x86_64 #1 SMP Wed Jun 25 10:21:27 CST 2025 x86_64 x86_64 x86_64 GNU/Linux
ROCm ç‰ˆæœ¬: HIP version: 7.0.51831-7c9236b16
GPU è®¾å¤‡:   Name:                    Intel(R) Xeon(R) Platinum 8480C    
```

---

## æ—¥å¿—é…ç½®

```bash
AMD_LOG_LEVEL        = 5 (æœ€è¯¦ç»†)
HIP_TRACE_API        = 1 (å¯ç”¨)
HIP_DB               = 0x1 (debug)
AMD_SERIALIZE_KERNEL = 0 (ä¸ä¸²è¡ŒåŒ–)
GPU_MAX_HW_QUEUES    = 8
```

---

## æµ‹è¯•ç»“æœ

### test_concurrent
- æ—¥å¿—æ–‡ä»¶: `test_concurrent.log`
- Stream åˆ›å»º: `stream_create.txt` (8 æ¡)
- Queue åˆ›å»º: `queue_create.txt` (0 æ¡)
- Doorbell ä¿¡æ¯: `doorbell.txt` (1 æ¡)
- Priority ä¿¡æ¯: `priority.txt` (28 æ¡)
- Warnings: `warnings.txt` (0 æ¡)

---

## å…³é”®å‘ç°

### Stream åˆ›å»ºè®°å½•

```
:3:hip_stream.cpp           :293 : 20159561929 us: [pid:459769 tid: 0x7f8edc1c4400] [32m hipStreamCreateWithPriority ( 0x7fffea224e88, 0, -1 ) [0m
:3:hip_stream.cpp           :308 : 20159685100 us: [pid:459769 tid: 0x7f8edc1c4400] hipStreamCreateWithPriority: Returned hipSuccess : stream:0x1952020
:3:hip_stream.cpp           :293 : 20159685107 us: [pid:459769 tid: 0x7f8edc1c4400] [32m hipStreamCreateWithPriority ( 0x7fffea224e80, 0, 1 ) [0m
:3:hip_stream.cpp           :308 : 20159690220 us: [pid:459769 tid: 0x7f8edc1c4400] hipStreamCreateWithPriority: Returned hipSuccess : stream:0x20a2490
:3:hip_stream.cpp           :293 : 20159690227 us: [pid:459769 tid: 0x7f8edc1c4400] [32m hipStreamCreateWithPriority ( 0x7fffea224e78, 0, -1 ) [0m
:3:hip_stream.cpp           :308 : 20159695165 us: [pid:459769 tid: 0x7f8edc1c4400] hipStreamCreateWithPriority: Returned hipSuccess : stream:0x2099db0
:3:hip_stream.cpp           :293 : 20159695171 us: [pid:459769 tid: 0x7f8edc1c4400] [32m hipStreamCreateWithPriority ( 0x7fffea224e70, 0, 0 ) [0m
:3:hip_stream.cpp           :308 : 20159700277 us: [pid:459769 tid: 0x7f8edc1c4400] hipStreamCreateWithPriority: Returned hipSuccess : stream:0x208cd70
```

### Queue åˆ›å»ºè®°å½•

```

```

### Doorbell ä¿¡æ¯

```
  2. cat /proc/459769/maps | grep doorbell
```

### Warnings (å‰ 20 æ¡)

```

```

---

## åˆ†æå»ºè®®

1. æ£€æŸ¥ `stream_create.txt` ç¡®è®¤ 4 ä¸ª Stream åˆ›å»º
2. æ£€æŸ¥ `queue_create.txt` ç¡®è®¤ 4 ä¸ª Queue åˆ›å»º
3. æ£€æŸ¥ `doorbell.txt` ç¡®è®¤ 4 ä¸ªä¸åŒçš„ doorbell åœ°å€
4. æ£€æŸ¥ `warnings.txt` åˆ†ææ˜¯å¦æœ‰å®è´¨æ€§é—®é¢˜

---

## æ–‡ä»¶åˆ—è¡¨

```bash
ls -lh logs_20260129_175731/
```

```
total 128K
-rw-rw-r-- 1 zhehan zhehan   36 Jan 29 17:57 compile.log
-rw-rw-r-- 1 zhehan zhehan   43 Jan 29 17:57 doorbell.txt
-rw-rw-r-- 1 zhehan zhehan 4.1K Jan 29 17:57 priority.txt
-rw-rw-r-- 1 zhehan zhehan    0 Jan 29 17:57 queue_create.txt
-rw-rw-r-- 1 zhehan zhehan 1.2K Jan 29 17:57 stream_create.txt
-rw-rw-r-- 1 zhehan zhehan 107K Jan 29 17:57 test_concurrent.log
-rw-rw-r-- 1 zhehan zhehan    0 Jan 29 17:58 TEST_REPORT.md
-rw-rw-r-- 1 zhehan zhehan    0 Jan 29 17:57 warnings.txt
```

[0;32mâœ… æµ‹è¯•æŠ¥å‘Šå·²ç”Ÿæˆ: logs_20260129_175731/TEST_REPORT.md[0m

[0;34mâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[0;34måç»­åˆ†æ[0m
[0;34mâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
1ï¸âƒ£ æŸ¥çœ‹å®Œæ•´æ—¥å¿—:
   cat logs_20260129_175731/test_concurrent.log

2ï¸âƒ£ æœç´¢ç‰¹å®šå…³é”®è¯:
   grep -i 'queue' logs_20260129_175731/test_concurrent.log
   grep -i 'stream' logs_20260129_175731/test_concurrent.log
   grep -i 'doorbell' logs_20260129_175731/test_concurrent.log

3ï¸âƒ£ æŸ¥çœ‹ Warning è¯¦æƒ…:
   cat logs_20260129_175731/warnings.txt

4ï¸âƒ£ æŸ¥çœ‹æµ‹è¯•æŠ¥å‘Š:
   cat logs_20260129_175731/TEST_REPORT.md

5ï¸âƒ£ ä½¿ç”¨ less åˆ†é¡µæŸ¥çœ‹:
   less logs_20260129_175731/test_concurrent.log

[0;34mâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[0;34mæµ‹è¯•å®Œæˆ[0m
[0;34mâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m
[0;32mâœ… æ‰€æœ‰æ—¥å¿—å·²ä¿å­˜åˆ°: logs_20260129_175731/[0m

å¦‚æœå‘ç° Warningsï¼Œè¯·æ£€æŸ¥:
  â€¢ logs_20260129_175731/warnings.txt - æ‰€æœ‰è­¦å‘Šä¿¡æ¯
  â€¢ logs_20260129_175731/test_concurrent.log - å®Œæ•´æ—¥å¿—

