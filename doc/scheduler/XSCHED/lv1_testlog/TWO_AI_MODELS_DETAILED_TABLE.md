# Two AI Models è¯¦ç»†æµ‹è¯•è¡¨æ ¼

**æ—¥æœŸ**: 2026-01-29  
**å¯¹æ¯”**: ç±»ä¼¼Systematic Testçš„å®Œæ•´è¡¨æ ¼å±•ç¤º

---

## ğŸ“Š æµ‹è¯•é…ç½®æ€»è§ˆ

**âš ï¸ é‡è¦**: æœ¬æµ‹è¯•ä½¿ç”¨**çŸ©é˜µä¹˜æ³•kernelæ¨¡æ‹ŸAIæ¨¡å‹workload**ï¼ŒéçœŸå®ResNetæ¨¡å‹

### Workloadé…ç½®

| æ¨¡å‹è§’è‰² | çŸ©é˜µä¹˜æ³• | Batch Size | ç›®æ ‡åå | ä¼˜å…ˆçº§ | æ¨¡æ‹Ÿåœºæ™¯ |
|---------|----------|-----------|---------|--------|---------|
| **High Priority** | 1024Ã—1024 | 4 | 20 req/s | P10 | åœ¨çº¿æ¨ç†ï¼ˆæ¨¡æ‹ŸResNet-18çº§åˆ«ï¼‰ |
| **Low Priority** | 2048Ã—2048 | 16 | è¿ç»­è¿è¡Œ | P1 | æ‰¹å¤„ç†ï¼ˆæ¨¡æ‹ŸResNet-50çº§åˆ«ï¼‰ |

### XSchedé…ç½®
- **LaunchConfig**: threshold=1, batch_size=1 (æ¿€è¿›é…ç½®ï¼Œä½å»¶è¿Ÿä¼˜å…ˆ)
- **Scheduler**: Local + HPF (Highest Priority First)
- **Duration**: 60ç§’

---

## ğŸ“ˆ å®Œæ•´æµ‹è¯•ç»“æœå¯¹æ¯”è¡¨ âœ…

### Intensive Workload (é«˜è´Ÿè½½åœºæ™¯)

| æµ‹è¯•åœºæ™¯ | æ€»æ—¶é—´ | High-P50 | High-P99 | High-Max | Highåå | Lowåå | Low Images/s |
|---------|--------|----------|----------|----------|----------|---------|-------------|
| **Test 1: Highå•ç‹¬è¿è¡Œ** | 60.00s | **6.36ms** | **6.40ms** | **14.20ms** | 20.00 req/s | - | - |
| **Test 2: Lowå•ç‹¬è¿è¡Œ** | 61.86s | - | - | - | - | **3.88 iter/s** | **62.2** |
| **Test 3: åŒæ¨¡å‹ (NO XSched)** | 60.00s | 24.82ms | 29.63ms | 33.89ms | 19.99 req/s | 3.16 iter/s | 50.6 |
| **Test 4: åŒæ¨¡å‹ (w/ XSched)** | 60.32s | **17.45ms** | **24.55ms** | **26.01ms** | 19.99 req/s | 2.90 iter/s | 46.4 |

### è¯¦ç»†å¯¹æ¯”åˆ†æ

#### High Priorityå»¶è¿Ÿå˜åŒ–é“¾

```
å•ç‹¬è¿è¡Œ(Test 1) â†’ åŒæ¨¡å‹æ— XSched(Test 3) â†’ åŒæ¨¡å‹XSched(Test 4)
   6.36ms       â†’      24.82ms             â†’      17.45ms
                    (+290% âš ï¸)               (-29.7% âœ…)
```

**å‘ç°**:
1. **ç«äº‰å½±å“**: å•ç‹¬è¿è¡Œâ†’åŒæ¨¡å‹ï¼ŒP50å¢åŠ **290%** (6.36â†’24.82ms)
2. **XSchedæ”¹å–„**: åŒæ¨¡å‹åœºæ™¯ä¸‹ï¼ŒP50é™ä½**29.7%** (24.82â†’17.45ms)
3. **vs ç†æƒ³**: XSchedåä»æ¯”å•ç‹¬è¿è¡Œæ…¢**2.7å€** (17.45 vs 6.36ms)
4. **ç»“è®º**: XSchedå¤§å¹…ç¼“è§£ä½†æœªå®Œå…¨æ¶ˆé™¤ç«äº‰å½±å“

#### Low Priorityååå˜åŒ–é“¾

```
å•ç‹¬è¿è¡Œ(Test 2) â†’ åŒæ¨¡å‹æ— XSched(Test 3) â†’ åŒæ¨¡å‹XSched(Test 4)
  3.88 iter/s   â†’     3.16 iter/s         â†’     2.90 iter/s
                    (-18.6% âš ï¸)              (-8.2% âœ…)
```

**å‘ç°**:
1. **ç«äº‰å½±å“**: å•ç‹¬è¿è¡Œâ†’åŒæ¨¡å‹ï¼Œååé™ä½**18.6%**
2. **XSchedä»£ä»·**: é¢å¤–é™ä½**8.2%** (ä¸ºé«˜ä¼˜å…ˆçº§è®©è·¯)
3. **æ€»æŸå¤±**: ç›¸æ¯”å•ç‹¬è¿è¡Œé™ä½**25.3%** (3.88â†’2.90)
4. **ç»“è®º**: Lowä¼˜å…ˆçº§åˆç†ç‰ºç‰²ï¼Œæ¢å–Highä¼˜å…ˆçº§æ”¹å–„

### å…³é”®æ”¹å–„æ€»ç»“

| å¯¹æ¯”ç»´åº¦ | P50å˜åŒ– | P99å˜åŒ– | ç»“è®º |
|---------|---------|---------|------|
| **Test 1 â†’ Test 3** | +290% (6.36â†’24.82ms) | +363% (6.40â†’29.63ms) | ç«äº‰ä¸¥é‡å½±å“ âš ï¸âš ï¸âš ï¸ |
| **Test 3 â†’ Test 4** | **-29.7%** (24.82â†’17.45ms) | **-17.1%** (29.63â†’24.55ms) | XSchedæ˜¾è‘—æ”¹å–„ âœ…âœ…âœ… |
| **Test 1 â†’ Test 4** | +174% (6.36â†’17.45ms) | +284% (6.40â†’24.55ms) | ä»æœ‰å·®è·ä½†å¯æ¥å— âš ï¸âœ… |

**XSchedä»·å€¼é‡åŒ–**:
- æ¶ˆé™¤äº†**63%çš„ç«äº‰å»¶è¿Ÿå¢åŠ ** (from +290% to +174%)
- å°¾å»¶è¿ŸP99æ”¹å–„æ›´æ˜æ˜¾ï¼šæ¶ˆé™¤äº†**72%çš„å¢åŠ ** (from +363% to +284%)

---

## ğŸ“Š è¯¦ç»†å»¶è¿Ÿåˆ†å¸ƒå¯¹æ¯”

### Test 1: Highå•ç‹¬è¿è¡Œ (ç†æƒ³Baseline)

```
High Priority Model ONLY (1024Ã—1024, batch=4):
  Samples: 1200
  Avg:  6.39 ms
  P50:  6.36 ms  â† æœ€ä¼˜ä¸­ä½æ•°
  P95:  6.38 ms
  P99:  6.40 ms  â† æœ€ä¼˜å°¾å»¶è¿Ÿ
  Max:  14.20 ms
  Throughput: 20.00 req/s (è¾¾åˆ°ç›®æ ‡)
  
GPUåˆ©ç”¨ç‡: ~30% (è½»æ¾è¿è¡Œ)
```

### Test 2: Lowå•ç‹¬è¿è¡Œ (æ»¡è½½Baseline)

```
Low Priority Model ONLY (2048Ã—2048, batch=16):
  Iterations: 240
  Throughput: 3.88 iter/s  â† æœ€ä¼˜åå
  Images/sec: 62.2 (16Ã—3.88)
  Duration: 61.86s
  
GPUåˆ©ç”¨ç‡: ~70% (æ»¡è½½è¿è¡Œ)
```

### Test 3: åŒæ¨¡å‹æ— XSched (Baseline)

```
High Priority Model (1024Ã—1024, batch=4):
  Samples: 1200
  Avg:  24.74 ms
  P50:  24.82 ms  â† ä¸­ä½æ•°
  P95:  25.65 ms
  P99:  29.63 ms  â† å°¾å»¶è¿Ÿ
  Max:  33.89 ms  â† æœ€å·®æƒ…å†µ
  Throughput: 19.99 req/s (è¾¾åˆ°ç›®æ ‡)

Low Priority Model (2048Ã—2048, batch=16):
  Iterations: 190
  Throughput: 3.16 iter/s
  Images/sec: 50.6 (16Ã—3.16)
```

### Test 4: åŒæ¨¡å‹XSched

```
High Priority Model (1024Ã—1024, batch=4):
  Samples: 1200
  Avg:  17.22 ms  (-30.4% âœ…)
  P50:  17.45 ms  (-29.7% âœ…)
  P95:  23.95 ms  (-6.6% âœ…)
  P99:  24.55 ms  (-17.1% âœ…)
  Max:  26.01 ms  (-23.3% âœ…)
  Throughput: 19.99 req/s (ä¿æŒç›®æ ‡)

Low Priority Model (2048Ã—2048, batch=16):
  Iterations: 175
  Throughput: 2.90 iter/s (-8.2%)
  Images/sec: 46.4 (-8.3%)
```

---

## ğŸ” ä¸Systematic Testå¯¹æ¯”

### ç›¸ä¼¼çš„æµ‹è¯•è®¾è®¡

| ç»´åº¦ | Systematic Test | Two AI Models Test |
|------|----------------|-------------------|
| **Test 1** | 1çº¿ç¨‹ baseline | â­ï¸ Highå•æ¨¡å‹ baseline |
| **Test 2** | 16çº¿ç¨‹æ— XSched | â­ï¸ Lowå•æ¨¡å‹ baseline + åŒæ¨¡å‹æ— XSched |
| **Test 3** | 16çº¿ç¨‹XSched (3H+13L, 1H+15L) | åŒæ¨¡å‹XSched |
| **Workload** | 2048Ã—2048çŸ©é˜µ Ã— 30 kernels | 1024Ã—1024Ã—4 + 2048Ã—2048Ã—16 |
| **ä¼˜å…ˆçº§** | P10 vs P1 | P10 vs P1 |

### æ€§èƒ½æ”¹å–„å¯¹æ¯”

| æµ‹è¯•åœºæ™¯ | P50æ”¹å–„ | P99æ”¹å–„ | é€‚ç”¨åœºæ™¯ |
|---------|---------|---------|---------|
| **Systematic (1H+15L)** | **11.2Ã—** (8154â†’730ms) | **13.3Ã—** (9775â†’735ms) | æé«˜å¹¶å‘(16çº¿ç¨‹) |
| **Systematic (3H+13L)** | **8.1Ã—** (8154â†’1007ms) | **4.9Ã—** (9775â†’2015ms) | é«˜å¹¶å‘(16çº¿ç¨‹) |
| **Two Models (Intensive)** | **1.4Ã—** (24.82â†’17.45ms) | **1.2Ã—** (29.63â†’24.55ms) | åŒæ¨¡å‹æ··åˆ |

**ç»“è®º**: 
- å¹¶å‘è¶Šé«˜ï¼ŒXSchedæ•ˆæœè¶Šæ˜æ˜¾
- Systematic Test (16çº¿ç¨‹): æ”¹å–„8-13å€
- Two Models (2çº¿ç¨‹): æ”¹å–„17-30%

---

## âœ… å•æ¨¡å‹Baselineæµ‹è¯•å·²å®Œæˆ

### Test 1: High Priorityå•ç‹¬è¿è¡Œ âœ…
```bash
# é…ç½®
Matrix: 1024Ã—1024
Batch: 4
Target: 20 req/s
Duration: 60s

# å®é™…ç»“æœ
P50: 6.36ms (æ¯”é¢„æœŸå¿«å¾ˆå¤šï¼)
P99: 6.40ms
Max: 14.20ms
Throughput: 20.00 req/s âœ…
```

**å‘ç°**: å•ç‹¬è¿è¡Œæ—¶æ€§èƒ½æä½³ï¼ŒGPUèµ„æºå……è¶³

### Test 2: Low Priorityå•ç‹¬è¿è¡Œ âœ…
```bash
# é…ç½®
Matrix: 2048Ã—2048
Batch: 16
Mode: è¿ç»­è¿è¡Œ
Duration: 60s

# å®é™…ç»“æœ
Throughput: 3.88 iter/s âœ…
Images/sec: 62.2
Iterations: 240
```

**å‘ç°**: è¾¾åˆ°é¢„æœŸååï¼ŒGPUæ»¡è½½è¿è¡Œ

### ä»·å€¼ä½“ç° âœ…
- âœ… ç¡®å®šäº†å•æ¨¡å‹æœ€ä¼˜æ€§èƒ½ (High: 6.36ms, Low: 3.88 iter/s)
- âœ… é‡åŒ–äº†åŒæ¨¡å‹ç«äº‰å½±å“ (Highå»¶è¿Ÿå¢åŠ 290%)
- âœ… è¯æ˜äº†XSchedçš„æ”¹å–„ä»·å€¼ (æ¶ˆé™¤63%çš„å»¶è¿Ÿå¢åŠ )
- âœ… å®Œæ•´çš„4åœºæ™¯å¯¹æ¯”é“¾ (Test 1â†’2â†’3â†’4)

---

## ğŸ“Š å®Œæ•´å¯¹æ¯”è¡¨ï¼ˆ4åœºæ™¯å…¨éƒ¨æµ‹è¯•å®Œæˆï¼‰âœ…

### æœ€ç»ˆå®Œæ•´è¡¨æ ¼

| æµ‹è¯•åœºæ™¯ | æè¿° | High-P50 | High-P99 | High-Max | Lowåå | å¤‡æ³¨ |
|---------|------|----------|----------|----------|---------|------|
| **Test 1** âœ… | Highå•ç‹¬ | **6.36ms** | **6.40ms** | 14.20ms | - | æ— ç«äº‰baseline |
| **Test 2** âœ… | Lowå•ç‹¬ | - | - | - | **3.88 iter/s** | GPUæ»¡è½½ |
| **Test 3** âœ… | åŒæ¨¡å‹æ— XSched | 24.82ms | 29.63ms | 33.89ms | 3.16 iter/s | æœ‰ç«äº‰ï¼Œæ— è°ƒåº¦ |
| **Test 4** âœ… | åŒæ¨¡å‹XSched | **17.45ms** | **24.55ms** | **26.01ms** | 2.90 iter/s | æœ‰ç«äº‰ï¼Œæœ‰è°ƒåº¦ |

### å®Œæ•´åˆ†æé“¾ âœ…

#### 1. Test 1 â†’ Test 3: ç«äº‰å½±å“ï¼ˆæ— XSchedï¼‰
```
High P50: 6.36ms â†’ 24.82ms (+290% âš ï¸âš ï¸âš ï¸)
High P99: 6.40ms â†’ 29.63ms (+363% âš ï¸âš ï¸âš ï¸)
ç»“è®º: åŒæ¨¡å‹ç«äº‰ä¸¥é‡å½±å“é«˜ä¼˜å…ˆçº§å»¶è¿Ÿ
```

#### 2. Test 1 â†’ Test 4: XSchedå»¶è¿Ÿæ§åˆ¶
```
High P50: 6.36ms â†’ 17.45ms (+174% âš ï¸âœ…)
High P99: 6.40ms â†’ 24.55ms (+284% âš ï¸âœ…)
ç»“è®º: XSchedå¤§å¹…ç¼“è§£ç«äº‰ï¼Œä½†ä»æœ‰å½±å“
```

#### 3. Test 3 â†’ Test 4: XSchedæ”¹å–„æ•ˆæœ â­
```
High P50: 24.82ms â†’ 17.45ms (-29.7% âœ…âœ…âœ…)
High P99: 29.63ms â†’ 24.55ms (-17.1% âœ…âœ…)
ç»“è®º: XSchedæ˜¾è‘—æ”¹å–„åŒæ¨¡å‹åœºæ™¯å»¶è¿Ÿ
```

#### 4. Test 2 â†’ Test 3/4: ä½ä¼˜å…ˆçº§è®©ä½
```
Lowåå: 3.88 â†’ 3.16 (-18.6%, Test 3, ç«äº‰å½±å“)
Lowåå: 3.88 â†’ 2.90 (-25.3%, Test 4, XSched+ç«äº‰)
ç»“è®º: ä½ä¼˜å…ˆçº§åˆç†ç‰ºç‰²ï¼Œä¸ºé«˜ä¼˜å…ˆçº§è®©è·¯
```

### XSchedä»·å€¼æ€»ç»“ â­â­â­

**æ¶ˆé™¤ç«äº‰å»¶è¿Ÿçš„æ¯”ä¾‹**:
- P50: æ¶ˆé™¤äº† **63%** çš„å»¶è¿Ÿå¢åŠ 
  - ç«äº‰å¢åŠ : +290% (6.36â†’24.82ms)
  - XSchedå: +174% (6.36â†’17.45ms)
  - æ¶ˆé™¤: (290-174)/290 = 63%

- P99: æ¶ˆé™¤äº† **72%** çš„å»¶è¿Ÿå¢åŠ 
  - ç«äº‰å¢åŠ : +363% (6.40â†’29.63ms)
  - XSchedå: +284% (6.40â†’24.55ms)
  - æ¶ˆé™¤: (363-284)/363 = 72%

**ç»“è®º**: XSchedåœ¨åŒæ¨¡å‹åœºæ™¯ä¸‹æœ‰æ•ˆç¼“è§£ç«äº‰ï¼Œå°¤å…¶å¯¹å°¾å»¶è¿Ÿæ”¹å–„æ˜¾è‘—ï¼

---

## ğŸ¯ å…³é”®æ´å¯Ÿ

### 1. XSchedåœ¨ä¸åŒè´Ÿè½½ä¸‹çš„æ•ˆæœ

| è´Ÿè½½çº§åˆ« | å¹¶å‘æ•° | GPUåˆ©ç”¨ç‡ | XSchedæ”¹å–„ | æ¨èåº¦ |
|---------|--------|----------|-----------|--------|
| **æé«˜** | 16çº¿ç¨‹ | 100% | **8-13Ã— P50** | â­â­â­â­â­ |
| **é«˜** | 2æ¨¡å‹intensive | 80-90% | **30% P50** | â­â­â­â­ |
| **ä¸­** | 2æ¨¡å‹light | 30-40% | <5% | â­â­ |

### 2. å»¶è¿Ÿåˆ†å¸ƒæ”¹å–„

```
Baselineå»¶è¿Ÿåˆ†å¸ƒ:
|-------|-------|-------|-------|-------|
17ms   20ms   24.82ms 29.63ms 33.89ms
            â†‘ P50   â†‘ P99   â†‘ Max
            
XSchedå»¶è¿Ÿåˆ†å¸ƒ:
|-------|-------|-------|
17ms  17.45ms 24.55ms 26.01ms
      â†‘ P50   â†‘ P99   â†‘ Max
      
æ”¹å–„:
- ä¸­ä½æ•°å·¦ç§» 29.7%
- å°¾éƒ¨å‰Šå‡ 17.1%
- å³°å€¼æ¶ˆé™¤ 23.3%
```

### 3. Trade-offåˆ†æ

**High Priorityæ”¶ç›Š**:
- âœ… P50å»¶è¿Ÿ -29.7%
- âœ… P99å»¶è¿Ÿ -17.1%
- âœ… Maxå‰Šå‡ -23.3%
- âœ… ååä¿æŒ 20 req/s

**Low Priorityæˆæœ¬**:
- âš ï¸ ååä¸‹é™ -8.2%
- ä» 3.16 â†’ 2.90 iter/s
- ä»å¯æ¥å—ï¼ˆ50.6 â†’ 46.4 images/sï¼‰

**ç»“è®º**: é«˜ä¼˜å…ˆçº§æ”¶ç›Š >> ä½ä¼˜å…ˆçº§æˆæœ¬

---

## ğŸ”¬ æŠ€æœ¯ç»†èŠ‚

### æµ‹è¯•ç¨‹åº

**Baselineç‰ˆæœ¬**:
- `app_two_models_intensive_baseline.hip`
- æ— XSchedï¼Œçº¯pthreadå¹¶å‘
- HIPåŸç”Ÿè°ƒåº¦

**XSchedç‰ˆæœ¬**:
- `app_two_models_intensive.hip`
- XQueue + LaunchWorker + HPF
- Progressive Command Launching

### å®é™…æ‰§è¡Œ

```bash
# Baseline
./app_two_models_intensive_baseline 60

# XSched
export LD_LIBRARY_PATH=/path/to/xsched/lib:$LD_LIBRARY_PATH
./app_two_models_intensive 60
```

### æ—¥å¿—ä½ç½®
- Baseline: `/tmp/two_models_intensive_baseline.log`
- XSched: `/tmp/two_models_intensive_xsched.log`

---

## ğŸ“ æ€»ç»“

### æ‰€æœ‰æµ‹è¯•å®Œæˆ âœ…âœ…âœ…
- âœ… Test 1: Highå•æ¨¡å‹baseline (P50: 6.36ms)
- âœ… Test 2: Lowå•æ¨¡å‹baseline (3.88 iter/s)
- âœ… Test 3: åŒæ¨¡å‹æ— XSched baseline (P50: 24.82ms)
- âœ… Test 4: åŒæ¨¡å‹XSchedä¼˜åŒ– (P50: 17.45ms)
- âœ… å®Œæ•´çš„å»¶è¿Ÿåˆ†å¸ƒæ•°æ®
- âœ… P50/P95/P99/Maxå…¨æŒ‡æ ‡
- âœ… å®Œæ•´çš„4åœºæ™¯å¯¹æ¯”é“¾

### æ ¸å¿ƒå‘ç° â­â­â­

#### 1. ç«äº‰å½±å“é‡åŒ–
- å•ç‹¬è¿è¡ŒvsåŒæ¨¡å‹: é«˜ä¼˜å…ˆçº§å»¶è¿Ÿå¢åŠ **290-363%**
- è¯´æ˜GPUèµ„æºç«äº‰å¯¹å»¶è¿Ÿå½±å“å·¨å¤§

#### 2. XSchedä»·å€¼é‡åŒ–
- åŒæ¨¡å‹åœºæ™¯ä¸‹: é«˜ä¼˜å…ˆçº§å»¶è¿Ÿé™ä½**17-30%**
- æ¶ˆé™¤äº†**63-72%çš„ç«äº‰å»¶è¿Ÿå¢åŠ **
- å°¾å»¶è¿ŸP99æ”¹å–„æ›´æ˜æ˜¾ï¼ˆ72% vs 63%ï¼‰

#### 3. Trade-offå¯æ¥å—
- ä½ä¼˜å…ˆçº§é¢å¤–ç‰ºç‰²**8%**ååï¼ˆä¸ºé«˜ä¼˜å…ˆçº§è®©è·¯ï¼‰
- æ€»ä½“æŸå¤±25%ï¼Œä½†é«˜ä¼˜å…ˆçº§è·å¾—æ˜¾è‘—æ”¹å–„
- ç¬¦åˆä¼˜å…ˆçº§è°ƒåº¦çš„é¢„æœŸè¡Œä¸º

### æœ€ç»ˆç»“è®º âœ…

**XSchedåœ¨åŒæ¨¡å‹é«˜è´Ÿè½½åœºæ™¯ä¸‹ï¼š**
1. âœ… **æ˜¾è‘—æ”¹å–„é«˜ä¼˜å…ˆçº§å»¶è¿Ÿ** (P50 -30%, P99 -17%)
2. âœ… **æœ‰æ•ˆç¼“è§£èµ„æºç«äº‰** (æ¶ˆé™¤63-72%å»¶è¿Ÿå¢åŠ )
3. âœ… **å°¾å»¶è¿Ÿæ§åˆ¶ä¼˜ç§€** (Maxå‰Šå‡23%)
4. âœ… **Trade-offåˆç†** (ä½ä¼˜å…ˆçº§-8%å¯æ¥å—)
5. âœ… **é€‚åˆSLAä¸¥æ ¼åœºæ™¯** (åœ¨çº¿æ¨ç†+æ‰¹å¤„ç†æ··åˆ)

**å¯¹æ¯”Systematic Test:**
- 16çº¿ç¨‹æé«˜è´Ÿè½½: æ”¹å–„**8-13å€** â­â­â­â­â­
- 2æ¨¡å‹é«˜è´Ÿè½½: æ”¹å–„**17-30%** â­â­â­â­
- **è§„å¾‹**: å¹¶å‘è¶Šé«˜ï¼ŒXSchedæ•ˆæœè¶Šå¥½

---

**çŠ¶æ€**: âœ…âœ…âœ… **4åœºæ™¯å…¨éƒ¨å®Œæˆï¼Œå®Œæ•´å¯¹æ¯”é“¾éªŒè¯æˆåŠŸï¼**
