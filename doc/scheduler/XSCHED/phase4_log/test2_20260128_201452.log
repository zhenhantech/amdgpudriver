================================================
Phase 4 Test 2: Single Model Performance
================================================

Comparing Baseline vs XSched for single model
Container: zhenflashinfer_v1

[1/3] Copying test script...
  ✅ Script copied

[2/3] Running Baseline test (ResNet-18)...
/opt/conda/envs/py_3.12/lib/python3.12/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/opt/conda/envs/py_3.12/lib/python3.12/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=None`.
  warnings.warn(msg)
======================================================================
Phase 4 Test 2: Single Model Performance
======================================================================
Configuration:
  Model: resnet18
  Batch Size: 8
  Iterations: 50
  PyTorch: 2.7.1+rocm6.4.1.git2a215e4a
  CUDA: True
  Device: AMD Instinct MI308X

======================================================================
Testing resnet18 (batch=8, iterations=50)
======================================================================
[1/3] Loading model...
  ✅ Model loaded on cuda:0
[2/3] Warming up...
  ✅ Warmup complete
[3/3] Running 50 iterations...
  Progress: 10/50
  Progress: 20/50
  Progress: 30/50
  Progress: 40/50
  Progress: 50/50

======================================================================
Results for resnet18:
  Throughput: 373.88 iter/s
  Latency Avg: 2.67 ms
  Latency P50: 2.67 ms
  Latency P95: 2.69 ms
  Latency P99: 2.71 ms
  Latency Max: 2.72 ms
======================================================================

✅ Results saved to /data/dockercode/test_results_phase4/test2_baseline_resnet18.json
  ✅ Baseline test completed

[3/3] Running XSched test (ResNet-18)...
[INFO @ T65490 @ 12:15:06.247528] using app-managed scheduler
/opt/conda/envs/py_3.12/lib/python3.12/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/opt/conda/envs/py_3.12/lib/python3.12/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=None`.
  warnings.warn(msg)
======================================================================
Phase 4 Test 2: Single Model Performance
======================================================================
Configuration:
  Model: resnet18
  Batch Size: 8
  Iterations: 50
  PyTorch: 2.7.1+rocm6.4.1.git2a215e4a
  CUDA: True
  Device: AMD Instinct MI308X

======================================================================
Testing resnet18 (batch=8, iterations=50)
======================================================================
[1/3] Loading model...
  ✅ Model loaded on cuda:0
Traceback (most recent call last):
  File "/data/dockercode/test_phase4_2_single_model.py", line 120, in <module>
    sys.exit(main())
             ^^^^^^
  File "/data/dockercode/test_phase4_2_single_model.py", line 108, in main
    results = run_single_model_test(args.model, args.batch, args.iterations)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/dockercode/test_phase4_2_single_model.py", line 32, in run_single_model_test
    input_tensor = torch.randn(batch_size, 3, 224, 224, device=device)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: HIP error: invalid device function
HIP kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing AMD_SERIALIZE_KERNEL=3
Compile with `TORCH_USE_HIP_DSA` to enable device-side assertions.

