========================================================================
Phase 4: Dual Model Priority Scheduling Test
========================================================================

Test Configuration:
  Duration: 60s
  High Priority: ResNet-18 (10 reqs/sec)
  Low Priority:  ResNet-50 (continuous)

[1/5] Copying test script to container...
  ‚úÖ Script copied

========================================================================
[2/5] Running BASELINE test (Native scheduler, no XSched)
========================================================================

======================================================================
Phase 4: Dual Model Priority Scheduling Test
======================================================================

Test configuration:
  Duration: 60s
  High priority: ResNet-18, 10 reqs/sec
  Low priority:  ResNet-50, continuous

‚ÑπÔ∏è  Running with Native scheduler (no XSched)

Starting workers...
----------------------------------------------------------------------
[HIGH] Starting high priority task (ResNet-18)
[HIGH] Target: 10 reqs/sec, Duration: 60s
[HIGH] Warmup completed, starting test...

[HIGH] Results:
  Requests: 600
  Throughput: 9.99 req/s
  Latency Avg: 2.26 ms
  Latency P50: 2.24 ms
  Latency P95: 2.58 ms
  Latency P99: 2.67 ms
  Latency Max: 2.79 ms
[LOW] Starting low priority task (ResNet-50)
[LOW] Mode: Continuous inference, Duration: 60s
[LOW] Warmup completed, starting test...

[LOW] Results:
  Iterations: 9954
  Throughput: 165.90 iter/s
  Images/sec: 1327.2

======================================================================
FINAL RESULTS
======================================================================

High Priority (ResNet-18):
  P99 Latency: 2.67 ms
  Throughput:  9.99 req/s

Low Priority (ResNet-50):
  Throughput:  165.90 iter/s
  Images/sec:  1327.2

‚úÖ Results saved to /data/dockercode/test_results_phase4/baseline_result.json
======================================================================

‚úÖ High priority P99 (2.67ms) looks reasonable

========================================================================
[3/5] Running XSCHED test (With priority scheduling)
========================================================================

[INFO @ T75775 @ 16:25:46.574199] using app-managed scheduler
======================================================================
Phase 4: Dual Model Priority Scheduling Test
======================================================================

Test configuration:
  Duration: 60s
  High priority: ResNet-18, 10 reqs/sec
  Low priority:  ResNet-50, continuous

‚úÖ Running with XSched
   LD_PRELOAD: /data/dockercode/xsched-build/output/lib/libshimhip.so

Starting workers...
----------------------------------------------------------------------
[HIGH] Starting high priority task (ResNet-18)
[HIGH] Target: 10 reqs/sec, Duration: 60s
[HIGH] Warmup completed, starting test...

[HIGH] Results:
  Requests: 600
  Throughput: 9.99 req/s
  Latency Avg: 2.26 ms
  Latency P50: 2.24 ms
  Latency P95: 2.59 ms
  Latency P99: 2.73 ms
  Latency Max: 2.78 ms
[LOW] Starting low priority task (ResNet-50)
[LOW] Mode: Continuous inference, Duration: 60s
[LOW] Warmup completed, starting test...

[LOW] Results:
  Iterations: 9928
  Throughput: 165.46 iter/s
  Images/sec: 1323.7

======================================================================
FINAL RESULTS
======================================================================

High Priority (ResNet-18):
  P99 Latency: 2.73 ms
  Throughput:  9.99 req/s

Low Priority (ResNet-50):
  Throughput:  165.46 iter/s
  Images/sec:  1323.7

‚úÖ Results saved to /data/dockercode/test_results_phase4/xsched_result.json
======================================================================

‚úÖ High priority P99 (2.73ms) looks reasonable

========================================================================
[4/5] Comparing results...
========================================================================

======================================================================
COMPARISON: XSched vs Baseline
======================================================================

High Priority Task (ResNet-18):
----------------------------------------------------------------------
  Metric             Baseline      XSched        Change
  ------------------------------------------------------------
  P99 Latency (ms)       2.67          2.73        +2.0% ‚úÖ
  Avg Latency (ms)       2.26          2.26        -0.2%
  Throughput (rps)       9.99          9.99        -0.0%


Low Priority Task (ResNet-50):
----------------------------------------------------------------------
  Metric             Baseline      XSched        Change
  ------------------------------------------------------------
  Throughput (ips)     165.90        165.46        -0.3% ‚úÖ
  Images/sec           1327.2        1323.7        -0.3%

======================================================================
SUMMARY
======================================================================
‚úÖ High priority latency: GOOD (XSched P99 < 110% baseline)
‚úÖ Low priority throughput: GOOD (XSched = 99.7% of baseline, > 30%)

üéâ Overall: PASS

Key findings:
  - High priority task maintains good latency
  - Low priority task is not starved
  - XSched priority scheduling is working
======================================================================

========================================================================
[5/5] Generating final report...
========================================================================

cat: /data/dockercode/test_results_phase4/baseline_result.json: No such file or directory
Expecting value: line 1 column 1 (char 0)
cat: /data/dockercode/test_results_phase4/xsched_result.json: No such file or directory
Expecting value: line 1 column 1 (char 0)
‚úÖ Report generated: /data/dockercode/test_results_phase4/phase4_dual_model_report.md

========================================================================
‚úÖ Phase 4 Dual Model Test: PASSED
========================================================================

Results saved in:
  - Baseline:  zhenflashinfer_v1:/data/dockercode/test_results_phase4/baseline_result.json
  - XSched:    zhenflashinfer_v1:/data/dockercode/test_results_phase4/xsched_result.json
  - Report:    zhenflashinfer_v1:/data/dockercode/test_results_phase4/phase4_dual_model_report.md

View results:
  docker exec zhenflashinfer_v1 cat /data/dockercode/test_results_phase4/baseline_result.json
  docker exec zhenflashinfer_v1 cat /data/dockercode/test_results_phase4/xsched_result.json

Next step: Analyze results and proceed to Test 4.2 (Multi-tenant)
