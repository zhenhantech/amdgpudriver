========================================================================
Phase 4: Dual Model Priority Scheduling Test (Intensive)
========================================================================

Test Configuration:
  Duration: 180s (3 minutes)
  High Priority: ResNet-18 (20 reqs/sec, 50ms interval)
  Low Priority:  ResNet-50 (batch=1024, continuous)

[1/5] Copying test script to container...
  ‚úÖ Script copied

========================================================================
[2/5] Running BASELINE test (Native scheduler, no XSched)
========================================================================

======================================================================
Phase 4: Dual Model Priority Scheduling Test (Intensive)
======================================================================

Test configuration:
  Duration: 180s (3 minutes)
  High priority: ResNet-18, 20 reqs/sec (50ms interval)
  Low priority:  ResNet-50, batch=1024, continuous

‚ÑπÔ∏è  Running with Native scheduler (no XSched)

‚ö†Ô∏è  WARNING: This is an intensive test!
   - High request rate (20 req/s)
   - Large batch size (1024)
   - Long duration (3 minutes)
   - May require significant GPU memory

Starting workers...
----------------------------------------------------------------------
[HIGH] Starting high priority task (ResNet-18)
[HIGH] Target: 20 reqs/sec (50ms interval), Duration: 180s
[HIGH] Warming up...
[HIGH] Warmup completed, starting test...

[HIGH] Results:
  Requests: 3596
  Throughput: 19.98 req/s
  Latency Avg: 8.24 ms
  Latency P50: 7.69 ms
  Latency P95: 15.41 ms
  Latency P99: 19.38 ms
  Latency Max: 24.81 ms
[LOW] Starting low priority task (ResNet-50)
[LOW] Mode: Continuous inference, Batch=1024, Duration: 180s
[LOW] Allocating batch size 1024...
[LOW] Batch allocated successfully
[LOW] Warming up...
[LOW] Warmup completed, starting test...
[LOW] Progress: 10 iterations, 1.96 iter/s
[LOW] Progress: 20 iterations, 1.96 iter/s
[LOW] Progress: 30 iterations, 1.96 iter/s
[LOW] Progress: 40 iterations, 1.96 iter/s
[LOW] Progress: 50 iterations, 1.96 iter/s
[LOW] Progress: 60 iterations, 1.96 iter/s
[LOW] Progress: 70 iterations, 1.96 iter/s
[LOW] Progress: 80 iterations, 1.96 iter/s
[LOW] Progress: 90 iterations, 1.96 iter/s
[LOW] Progress: 100 iterations, 1.96 iter/s
[LOW] Progress: 110 iterations, 1.96 iter/s
[LOW] Progress: 120 iterations, 1.96 iter/s
[LOW] Progress: 130 iterations, 1.96 iter/s
[LOW] Progress: 140 iterations, 1.96 iter/s
[LOW] Progress: 150 iterations, 1.96 iter/s
[LOW] Progress: 160 iterations, 1.96 iter/s
[LOW] Progress: 170 iterations, 1.96 iter/s
[LOW] Progress: 180 iterations, 1.96 iter/s
[LOW] Progress: 190 iterations, 1.96 iter/s
[LOW] Progress: 200 iterations, 1.96 iter/s
[LOW] Progress: 210 iterations, 1.96 iter/s
[LOW] Progress: 220 iterations, 1.96 iter/s
[LOW] Progress: 230 iterations, 1.96 iter/s
[LOW] Progress: 240 iterations, 1.96 iter/s
[LOW] Progress: 250 iterations, 1.96 iter/s
[LOW] Progress: 260 iterations, 1.96 iter/s
[LOW] Progress: 270 iterations, 1.96 iter/s
[LOW] Progress: 280 iterations, 1.96 iter/s
[LOW] Progress: 290 iterations, 1.96 iter/s
[LOW] Progress: 300 iterations, 1.96 iter/s
[LOW] Progress: 310 iterations, 1.96 iter/s
[LOW] Progress: 320 iterations, 1.96 iter/s
[LOW] Progress: 330 iterations, 1.96 iter/s
[LOW] Progress: 340 iterations, 1.96 iter/s
[LOW] Progress: 350 iterations, 1.96 iter/s

[LOW] Results:
  Iterations: 354
  Batch size: 1024
  Throughput: 1.96 iter/s
  Images/sec: 2011.2

======================================================================
FINAL RESULTS
======================================================================

High Priority (ResNet-18, 20 req/s):
  Total Requests: 3596
  P99 Latency: 19.38 ms
  Throughput:  19.98 req/s

Low Priority (ResNet-50, batch=1024):
  Total Iterations: 354
  Throughput:  1.96 iter/s
  Images/sec:  2011.2

‚úÖ Results saved to /data/dockercode/test_results_phase4/baseline_intensive_result.json
======================================================================

‚úÖ High priority P99 (19.38ms) looks reasonable

‚úÖ Baseline test completed

========================================================================
[3/5] Running XSCHED test (With priority scheduling)
========================================================================

[INFO @ T75955 @ 16:30:51.367592] using app-managed scheduler
======================================================================
Phase 4: Dual Model Priority Scheduling Test (Intensive)
======================================================================

Test configuration:
  Duration: 180s (3 minutes)
  High priority: ResNet-18, 20 reqs/sec (50ms interval)
  Low priority:  ResNet-50, batch=1024, continuous

‚úÖ Running with XSched
   LD_PRELOAD: /data/dockercode/xsched-build/output/lib/libhalhip.so:/data/dockercode/xsched-build/output/lib/libshimhip.so

‚ö†Ô∏è  WARNING: This is an intensive test!
   - High request rate (20 req/s)
   - Large batch size (1024)
   - Long duration (3 minutes)
   - May require significant GPU memory

Starting workers...
----------------------------------------------------------------------
[HIGH] Starting high priority task (ResNet-18)
[HIGH] Target: 20 reqs/sec (50ms interval), Duration: 180s
[HIGH] Warming up...
[HIGH] Warmup completed, starting test...

[HIGH] Results:
  Requests: 3596
  Throughput: 19.98 req/s
  Latency Avg: 8.15 ms
  Latency P50: 7.61 ms
  Latency P95: 15.35 ms
  Latency P99: 20.45 ms
  Latency Max: 25.07 ms
[LOW] Starting low priority task (ResNet-50)
[LOW] Mode: Continuous inference, Batch=1024, Duration: 180s
[LOW] Allocating batch size 1024...
[LOW] Batch allocated successfully
[LOW] Warming up...
[LOW] Warmup completed, starting test...
[LOW] Progress: 10 iterations, 1.96 iter/s
[LOW] Progress: 20 iterations, 1.96 iter/s
[LOW] Progress: 30 iterations, 1.95 iter/s
[LOW] Progress: 40 iterations, 1.95 iter/s
[LOW] Progress: 50 iterations, 1.96 iter/s
[LOW] Progress: 60 iterations, 1.96 iter/s
[LOW] Progress: 70 iterations, 1.96 iter/s
[LOW] Progress: 80 iterations, 1.96 iter/s
[LOW] Progress: 90 iterations, 1.96 iter/s
[LOW] Progress: 100 iterations, 1.96 iter/s
[LOW] Progress: 110 iterations, 1.96 iter/s
[LOW] Progress: 120 iterations, 1.96 iter/s
[LOW] Progress: 130 iterations, 1.96 iter/s
[LOW] Progress: 140 iterations, 1.96 iter/s
[LOW] Progress: 150 iterations, 1.96 iter/s
[LOW] Progress: 160 iterations, 1.96 iter/s
[LOW] Progress: 170 iterations, 1.96 iter/s
[LOW] Progress: 180 iterations, 1.96 iter/s
[LOW] Progress: 190 iterations, 1.96 iter/s
[LOW] Progress: 200 iterations, 1.96 iter/s
[LOW] Progress: 210 iterations, 1.96 iter/s
[LOW] Progress: 220 iterations, 1.96 iter/s
[LOW] Progress: 230 iterations, 1.96 iter/s
[LOW] Progress: 240 iterations, 1.96 iter/s
[LOW] Progress: 250 iterations, 1.96 iter/s
[LOW] Progress: 260 iterations, 1.96 iter/s
[LOW] Progress: 270 iterations, 1.96 iter/s
[LOW] Progress: 280 iterations, 1.96 iter/s
[LOW] Progress: 290 iterations, 1.96 iter/s
[LOW] Progress: 300 iterations, 1.96 iter/s
[LOW] Progress: 310 iterations, 1.96 iter/s
[LOW] Progress: 320 iterations, 1.96 iter/s
[LOW] Progress: 330 iterations, 1.96 iter/s
[LOW] Progress: 340 iterations, 1.96 iter/s
[LOW] Progress: 350 iterations, 1.96 iter/s

[LOW] Results:
  Iterations: 353
  Batch size: 1024
  Throughput: 1.96 iter/s
  Images/sec: 2007.2

======================================================================
FINAL RESULTS
======================================================================

High Priority (ResNet-18, 20 req/s):
  Total Requests: 3596
  P99 Latency: 20.45 ms
  Throughput:  19.98 req/s

Low Priority (ResNet-50, batch=1024):
  Total Iterations: 353
  Throughput:  1.96 iter/s
  Images/sec:  2007.2

‚úÖ Results saved to /data/dockercode/test_results_phase4/xsched_intensive_result.json
======================================================================

‚úÖ High priority P99 (20.45ms) looks reasonable

‚úÖ XSched test completed

========================================================================
[4/5] Comparing results...
========================================================================

======================================================================
COMPARISON: XSched vs Baseline (Intensive Configuration)
======================================================================

High Priority Task (ResNet-18, 20 req/s):
----------------------------------------------------------------------
  Metric                        Baseline       XSched       Change
  ----------------------------------------------------------
  Requests                       3596.00      3596.00            
  P99 Latency (ms)                 19.38        20.45       +5.5% ‚úÖ
  Avg Latency (ms)                  8.24         8.15       -1.1% ‚úÖ
  Throughput (rps)                 19.98        19.98       -0.0%


Low Priority Task (ResNet-50, batch=1024):
----------------------------------------------------------------------
  Metric                        Baseline       XSched       Change
  ----------------------------------------------------------
  Iterations                       354.0        353.0            
  Throughput (ips)                   2.0          2.0       -0.2% ‚úÖ
  Images/sec                      2011.2       2007.2       -0.2% ‚úÖ

======================================================================
SUMMARY
======================================================================
‚úÖ High priority latency: GOOD (XSched P99 <= 110% baseline)
‚úÖ Low priority throughput: GOOD (XSched = 99.8% of baseline, >= 30%)

üéâ Overall: PASS

Key findings:
  - Test duration: 3 minutes (180s)
  - High priority: 20 req/s (2x original load)
  - Low priority: batch=1024 (128x original load)
======================================================================

========================================================================
[5/5] Generating final report...
========================================================================

‚úÖ Report generated: /data/dockercode/test_results_phase4/phase4_dual_model_intensive_report.md

========================================================================
‚úÖ Phase 4 Dual Model Test (Intensive): COMPLETED
========================================================================

Results saved in:
  - Baseline:  zhenflashinfer_v1:/data/dockercode/test_results_phase4/baseline_intensive_result.json
  - XSched:    zhenflashinfer_v1:/data/dockercode/test_results_phase4/xsched_intensive_result.json
  - Report:    zhenflashinfer_v1:/data/dockercode/test_results_phase4/phase4_dual_model_intensive_report.md

View results:
  docker exec zhenflashinfer_v1 cat /data/dockercode/test_results_phase4/baseline_intensive_result.json
  docker exec zhenflashinfer_v1 cat /data/dockercode/test_results_phase4/xsched_intensive_result.json
  docker exec zhenflashinfer_v1 cat /data/dockercode/test_results_phase4/phase4_dual_model_intensive_report.md

Next step: Analyze results and compare with original test (10 req/s, batch=8)
========================================================================
